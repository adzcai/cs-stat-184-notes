\begin{array}{l} \mathbf{function} \ \mathrm{sgd}(\theta_{\mathrm{init}}: \mathrm{Float}_{\mathopen{}\left( \mathrm{Array}, \textrm{" D"} \mathclose{}\right)}, \mathrm{estimate\_gradient}: \mathrm{Callable}_{\mathopen{}\left( \mathopen{}\left[ \mathrm{Float}_{\mathopen{}\left( \mathrm{Array}, \textrm{" D"} \mathclose{}\right)} \mathclose{}\right], \mathrm{Float}_{\mathopen{}\left( \mathrm{Array}, \textrm{" D"} \mathclose{}\right)} \mathclose{}\right)}, \eta: \mathrm{float}, n_{\mathrm{steps}}: \mathrm{int}) \\ \hspace{1em} \textrm{"Perform `n\_steps` steps of SGD.

    `estimate\_gradient` eats the current parameters and returns an estimate of the objective function's gradient at those parameters.
    "} \\ \hspace{1em} \theta \gets \theta_{\mathrm{init}} \\ \hspace{1em} \mathbf{for} \ \mathrm{step} \in \mathrm{range} \mathopen{}\left( n_{\mathrm{steps}} \mathclose{}\right) \ \mathbf{do} \\ \hspace{2em} \theta \gets \theta + \eta \cdot \mathrm{estimate\_gradient} \mathopen{}\left( \theta \mathclose{}\right) \\ \hspace{1em} \mathbf{end \ for} \\ \hspace{1em} \mathbf{return} \ \theta \\ \mathbf{end \ function} \end{array}