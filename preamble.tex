\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[margin=1in, twoside]{geometry}
\usepackage[indent]{parskip}
\usepackage{graphicx, subcaption, hyperref, sidenotes, enumitem, tabularx, todonotes, listings, biblatex, tikz, algpseudocode, csquotes}

\renewcommand{\familydefault}{\sfdefault}
\raggedbottom

\newenvironment{steps}
    {\begingroup \samepage \begin{enumerate}[label={\bfseries Step \arabic{*}.}]}
    {\end{enumerate} \endgroup}

\newenvironment{exercise}{\textbf{Exercise:}}{}
\newenvironment{remark}{\textbf{Remark:}}{}

\newcommand{\rltable}[3]{\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{States} & \textbf{Actions} &\textbf{Rewards} \\
        \hline
        #1 & #2 & #3 \\
        \hline
    \end{tabular}
\end{center}}

\addbibresource{\main/main.bib}

% ==================== HEADER STYLES ====================

\usepackage{fancyhdr, titlesec}

\setlength{\headheight}{16pt}
\pagestyle{fancy}

\fancyhf{} % clear all existing fields
\fancyhead[L]{\leftmark}
\fancyhead[R]{\rightmark}
\fancyfoot[RO, LE]{\thepage}

\titleformat
    {\section}
    {\vspace{2em}\titlerule[2pt]\bfseries\Large}
    {\thesection}
    {2em}
    {}



% ==================== MATH NOTATION ====================

% use tcolorbox theorems instead of amsthm
\usepackage{amsmath, amsfonts, amssymb}

\newcommand{\R}{\mathbb{R}}
\newcommand{\bop}{\mathcal{J}}
\newcommand{\cN}{\mathcal{N}}
\let\P\relax
\DeclareMathOperator{\P}{\mathbb{P}}
\renewcommand{\S}{\mathcal{S}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\qed}{$\blacksquare$}
\newcommand{\kl}[2]{\mathrm{KL}\left(#1 \parallel #2\right)}

% semantic commands
\newcommand{\hor}{H}
\newcommand{\lgr}{\mathcal{L}}
\newcommand{\hi}{h}
\newcommand{\st}{s}
\newcommand{\act}{a}
\newcommand{\Vopt}{V^\star}
\newcommand{\Qopt}{Q^\star}

\renewcommand{\tilde}{\widetilde}
\renewcommand{\hat}{\widehat}

\DeclareMathOperator*{\E}{\mathbb{E}}
\DeclareMathOperator*{\argmin}{\textrm{arg\ min}}
\DeclareMathOperator*{\argmax}{\textrm{arg\ max}}
\DeclareMathOperator*{\var}{\textrm{Var}}
\DeclareMathOperator*{\tr}{\textrm{Tr}}
\DeclareMathOperator*{\diag}{\textrm{diag}}

\allowdisplaybreaks


% ==================== TCOLORBOX CONFIGURATION ====================

\usepackage[many]{tcolorbox}

\newcommand{\customtheorem}[4]{
    \newcounter{#1}[section]
    \expandafter\newcommand\csname #1name\endcsname{#2}
    \expandafter\renewcommand\csname the#1\endcsname{\thesection.\arabic{#1}}
    \newtcbtheorem[use counter*=#1]
        {#1}
        {#2}
        {
            fonttitle=\bfseries,
            colback=#4,
            coltitle=black,
            enhanced,
            breakable,
            parbox=false,
            boxed title style={colback=#4},
            attach boxed title to top text left={
                yshift=-\tcboxedtitleheight/2,
                yshifttext=-\tcboxedtitleheight/2}
        }{#3}
}

\customtheorem{example}{Example}{eg}{violet!5}      % examples
\customtheorem{derivation}{Derivation}{dr}{white}   % long calculations
\customtheorem{definition}{Definition}{df}{blue!5}  % important new terms and algorithms
\customtheorem{theorem}{Theorem}{th}{green!5}       % theorems

