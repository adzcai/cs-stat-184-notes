{"kind":"Notebook","sha256":"1d811d4f9277f0c5eacfcc972f1e1143305ad661b6bcc284653e2f4ae98f279d","slug":"planning","location":"/planning.md","dependencies":[],"frontmatter":{"title":"8 Tree Search Methods","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.2"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Fall 2024","given":"Fall","family":"2024"},"name":"Fall 2024","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/adzcai/cs-stat-184-notes","numbering":{"all":{"enabled":true}},"math":{"\\E":{"macro":"\\mathop{\\mathbb{E}}"},"\\pr":{"macro":"\\mathop{\\mathbb{P}}"},"\\kl":{"macro":"\\mathrm{KL}\\left(#1\\parallel#2\\right)"},"\\ind":{"macro":"\\mathbf{1}\\left\\{#1\\right\\}"},"\\hi":{"macro":"h"},"\\hor":{"macro":"H"},"\\st":{"macro":"s"},"\\act":{"macro":"a"}},"thumbnail":"/build/tic_tac_toe-b48eec3dc0012079611b6294983f5b74.png","thumbnailOptimized":"/build/tic_tac_toe-b48eec3dc0012079611b6294983f5b74.webp","exports":[{"format":"md","filename":"planning.md","url":"/build/planning-acb6689e7468591cc47aa78197f358ce.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gj7T02Hp8H"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"enumerator":"1","key":"UE7HcVuT3o"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Have you ever lost a strategy game against a skilled opponent?\nIt probably seemed like they were ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZRofdisPn8"},{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"ahead of you at every turn","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"AXxsMNDLjX"}],"key":"xQN4ZpwYDs"},{"type":"text","value":".\nThey might have been ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"dOhMh3FdzB"},{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"planning ahead","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QqBteEhGkw"}],"key":"zfB8KPqerG"},{"type":"text","value":" and anticipating your actions,\nthen formulating their strategy to counter yours.\nIf this opponent was a computer,\nthey might have been using one of the strategies that we are about to explore.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"zFN1i0glvO"}],"key":"kYRowpX45t"}],"key":"Napz361BZb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%load_ext autoreload\n%autoreload 2","key":"xrFMPfAUdv"},{"type":"output","id":"f0y4nechgOuFD-NTd5vSz","data":[],"key":"gLC17LMIle"}],"data":{},"key":"izI5E1jxSn"},{"type":"block","children":[],"key":"UCdj4DEFma"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from utils import Int, Array, latex, jnp\nfrom enum import IntEnum","key":"cHSPDKNCNw"},{"type":"output","id":"TdgI318qbrgwQp3cYY5oo","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)\nCell \u001b[0;32mIn[2], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mutils\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Int, Array, latex, jnp\n\u001b[1;32m      2\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01menum\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m IntEnum\n\n\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'utils'","ename":"ModuleNotFoundError","evalue":"No module named 'utils'"}],"key":"P3FsXImAUm"}],"data":{},"key":"neYO59dqRu"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Deterministic, zero sum, fully observable two-player games","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"nWMHOZ6wpY"}],"identifier":"deterministic-zero-sum-fully-observable-two-player-games","label":"Deterministic, zero sum, fully observable two-player games","html_id":"deterministic-zero-sum-fully-observable-two-player-games","implicit":true,"enumerator":"2","key":"E9wqgSXoq1"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"In this chapter, we will focus on games that are:","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"pMqfuTBpEG"}],"key":"cRrcS5XFCY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":41,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"deterministic,","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"TSNY5zokkL"}],"key":"Jeol3PHfxg"}],"key":"OgBz1GaxaG"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"zero sum","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"JG9OPFbZSc"}],"key":"Zmd7uqgM0m"},{"type":"text","value":" (one player wins and the other loses),","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"cdjcZpEr4Q"}],"key":"DIsfMnfJpU"},{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"fully observable,","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"nJPbuy45RY"}],"key":"MhUX02KUIj"},{"type":"text","value":" that is, the state of the game is perfectly known by both players,","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"CsFapCwUSX"}],"key":"c9hmL7yz4W"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"A3XKIotrV8"},{"type":"emphasis","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"two players","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Gs1kR14SIe"}],"key":"m8L4EDc4mg"},{"type":"text","value":" that alternate turns,","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"kMCDAlplqq"}],"key":"MoXP7QilZ4"}],"key":"pyBNYYGXyE"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"We can represent such a game as a ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"jUXagK2Ai8"},{"type":"emphasis","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"complete game tree.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"sisPEuoPEr"}],"key":"kvno433v5L"},{"type":"text","value":"\nEach possible state is a node in the tree,\nand since we only consider deterministic games,\nwe can represent actions as edges leading from the current state to the next.\nEach path through the tree, from root to leaf, represents a single game.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"hEdIWffdIz"}],"key":"AJoV3GSJdd"}],"key":"JFYUGv7Xma"},{"type":"block","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/build/tic_tac_toe-b48eec3dc0012079611b6294983f5b74.png","alt":"The first two layers of the complete game tree of tic-tac-toe.\nFrom Wikimedia.","align":"center","data":{"altTextIsAutoGenerated":true},"key":"ykJRc9NLD6","urlSource":"shared/tic_tac_toe.png","urlOptimized":"/build/tic_tac_toe-b48eec3dc0012079611b6294983f5b74.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"The first two layers of the complete game tree of tic-tac-toe.\nFrom Wikimedia.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Msrcdm2mv7"}],"key":"z2HqNeE5ty"}],"key":"jzRZRUJ3jM"}],"enumerator":"1","key":"FRyYEU0A2r"}],"key":"IOxUvhv3Wz"},{"type":"block","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"If you could store the complete game tree on a computer,\nyou would be able to win every potentially winnable game\nby searching all paths from your current state and taking a winning move.\nWe will see an explicit algorithm for this in ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"w6kfhW2z7p"},{"type":"crossReference","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"the next section","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"IfSOTYqMZx"}],"identifier":"min-max-search","label":"min-max-search","kind":"heading","template":"Section %s","enumerator":"3","resolved":true,"html_id":"min-max-search","key":"wfM7sqHCfo"},{"type":"text","value":".\nHowever, as games become more complex,\nit becomes computationally impossible to search every possible path.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"YBx17J5rou"}],"key":"PHBciaI4HT"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"For instance,\na chess player has roughly 30 actions to choose from at each turn,\nand each game takes roughly 40 moves per player,\nso trying to solve chess exactly using minimax\nwould take somewhere on the order of ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"kP3S4YMoaR"},{"type":"inlineMath","value":"30^{80} \\approx 10^{118}","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><msup><mn>0</mn><mn>80</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>118</mn></msup></mrow><annotation encoding=\"application/x-tex\">30^{80} \\approx 10^{118}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">3</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">80</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">118</span></span></span></span></span></span></span></span></span></span></span></span>","key":"BqXZeIZZQ3"},{"type":"text","value":" operations.\nThat’s 10 billion billion billion billion billion billion billion billion billion billion billion billion billion operations.\nAs of the time of writing,\nthe fastest processor can achieve almost 10 GHz (10 billion operations per second),\nso to fully solve chess using minimax is many, many orders of magnitude out of reach.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"JClj78HU0E"}],"key":"qa3EiZNUjo"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"It is thus intractable, in any realistic setting, to solve the complete game tree exactly.\nLuckily, only a small fraction of those games ever occur in reality;\nLater in this chapter,\nwe will explore ways to ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"YYaHtNWYIw"},{"type":"emphasis","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"prune away","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"OxqpPU0PoC"}],"key":"vRP72mV1Wh"},{"type":"text","value":" parts of the tree that we know we can safely ignore.\nWe can also ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"veZq6hrQ6y"},{"type":"emphasis","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"approximate","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"HY0vfjQSdN"}],"key":"hHYyQAHB5y"},{"type":"text","value":" the value of a state without fully evaluating it.\nUsing these approximations, we can no longer ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"A304lYjdhu"},{"type":"emphasis","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"guarantee","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"JuEacZN0Qx"}],"key":"xbR0h78jvV"},{"type":"text","value":" winning the game,\nbut we can come up with strategies that will do well against most opponents.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"eKsco9TWpv"}],"key":"yO1Ja3Jsrg"}],"key":"VzDi5mq0NP"},{"type":"block","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Notation","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"kH1LbvRzBX"}],"identifier":"notation","label":"Notation","html_id":"notation","implicit":true,"enumerator":"2.1","key":"gaOaFM4Wv1"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Let us now describe these games formally.\nWe’ll call the first player Max and the second player Min.\nMax seeks to maximize the final game score,\nwhile Min seeks to minimize the final game score.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"QtuPfv1rEe"}],"key":"M8BFWmSpaL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":97,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"We’ll use ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"U8XCnqJRsP"},{"type":"inlineMath","value":"\\mathcal{S}","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">S</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span></span></span></span>","key":"jIwgYJYzvp"},{"type":"text","value":" to denote the set of all possible game states.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"leDgsG0al0"}],"key":"nvXjWoAUbO"},{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"The game begins in some ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"XhbJuk5ZDr"},{"type":"strong","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"initial state","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"H4xjAm0cHB"}],"key":"IivrS9Fxul"},{"type":"text","value":" ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"zR2HjcBsKA"},{"type":"inlineMath","value":"s_0 \\in \\mathcal{S}","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>0</mn></msub><mo>∈</mo><mi mathvariant=\"script\">S</mi></mrow><annotation encoding=\"application/x-tex\">s_0 \\in \\mathcal{S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span></span></span></span>","key":"r7Wu89WXt5"},{"type":"text","value":".","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"tWKYRpp765"}],"key":"rFOpqZjie6"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Max moves on even turn numbers ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"uSUiwxXZne"},{"type":"inlineMath","value":"h = 2n","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mn>2</mn><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h = 2n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"j7jKp9SrLz"},{"type":"text","value":",\nand Min moves on odd turn numbers ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"j4DKY86lnL"},{"type":"inlineMath","value":"h = 2n+1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">h = 2n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"KFo1r5Cbo2"},{"type":"text","value":",\nwhere ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"WB7l46ay9W"},{"type":"inlineMath","value":"n","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"HTMb3CqUF6"},{"type":"text","value":" is a natural number.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"w151EcGI2M"}],"key":"jGv412nTkj"},{"type":"listItem","spread":true,"position":{"start":{"line":102,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"The space of possible actions, ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"rGcFfo2PYE"},{"type":"inlineMath","value":"\\mathcal{A}_h(s)","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">A</mi><mi>h</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{A}_h(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"HeSqJZnvOW"},{"type":"text","value":",\ndepends on the state itself, as well as whose turn it is.\n(For example, in tic-tac-toe, Max can only play ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"uY9MBPQvoH"},{"type":"inlineCode","value":"X","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"d3hXs6KQvL"},{"type":"text","value":"s while Min can only play ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"RU2HO4C8ZB"},{"type":"inlineCode","value":"O","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"V3XPbsXnq7"},{"type":"text","value":"s.)","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"UdF8H6BNTZ"}],"key":"ERWIryGdVD"},{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"The game ends after ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"quE5gxzxVJ"},{"type":"inlineMath","value":"H","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"CxuwHMMU8r"},{"type":"text","value":" total moves (which might be even or odd). We call the final state a ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"DMXmDSxJVa"},{"type":"strong","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"terminal state","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"pKgypSYg72"}],"key":"UluoV3p0hW"},{"type":"text","value":".","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"mrrgzMnQrN"}],"key":"y0C97Kmhni"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"inlineMath","value":"P","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"wzSAmzeuZ4"},{"type":"text","value":" denotes the ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"NKtG69V29s"},{"type":"strong","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"state transitions","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Cikgz5xktU"}],"key":"wHKd2jPsCP"},{"type":"text","value":", that is,\n","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"yoeRUImSGG"},{"type":"inlineMath","value":"P(s, a)","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"eillIXtDhr"},{"type":"text","value":" denotes the resulting state when taking action ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Z5Hk3pHoWy"},{"type":"inlineMath","value":"a \\in \\mathcal{A}(s)","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>∈</mo><mi mathvariant=\"script\">A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a \\in \\mathcal{A}(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"EeXlJnNB66"},{"type":"text","value":" in state ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"vwMOy1XTtu"},{"type":"inlineMath","value":"s","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"PWXZECCvo3"},{"type":"text","value":". We’ll assume that this function is time-homogeneous (a.k.a. stationary) and doesn’t change across timesteps.","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"DWdtp3E561"}],"key":"NfbhSFvBtf"},{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"inlineMath","value":"r(s)","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"LwgsFXaA6I"},{"type":"text","value":" denotes the ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"p2Bt9b0c6Y"},{"type":"strong","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"game score","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"bZdB48NC6d"}],"key":"qbZVvfzT1N"},{"type":"text","value":" of the terminal state ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"GwqcmDPi3c"},{"type":"inlineMath","value":"s","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"S1S6PuBgPA"},{"type":"text","value":".\nNote that this is some positive or negative value seen by both players:\nA positive value indicates Max winning, a negative value indicates Min winning, and a value of ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"Y1f317qSZJ"},{"type":"text","value":"0","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"bCurbE3aOH"},{"type":"text","value":" indicates a tie.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"kPigkpoNJh"}],"key":"OekPg2TCSk"}],"key":"SmRgWyzc5P"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"We also call the sequence of states and actions a ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"quBa2FcYzP"},{"type":"strong","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"trajectory","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"F0IBWDAJEt"}],"key":"aCJAUOzfSo"},{"type":"text","value":".","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"bEyDQTeClS"}],"key":"pxnY57ROrf"},{"type":"admonition","kind":"attention","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Attention","key":"KUbCGjCvsp"}],"key":"aPP2F3hZjO"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Above, we suppose that the game ends after ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"MUaj28ktkN"},{"type":"inlineMath","value":"H","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"FzMonNv4iz"},{"type":"text","value":" total moves.\nBut most real games have a ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"rHf94qULRF"},{"type":"emphasis","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"variable","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"CuYrwE8GWx"}],"key":"iuBo77LZ0n"},{"type":"text","value":" length.\nHow would you describe this?","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"Mb9G3uVzoK"}],"key":"Jwy8EdAHIa"}],"key":"BAcImjijco"},{"type":"proof","kind":"example","label":"tic-tac-toe","identifier":"tic-tac-toe","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tic-tac-toe","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"QIonGnnSkV"}],"key":"iutlLSINLm"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Let us frame tic-tac-toe in this setting.","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"SUAoTN6h3A"}],"key":"WlJJ4oXiJy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":125,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":125,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Each of the ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"coKZazw1ht"},{"type":"text","value":"9","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"C9L8cLm1Wh"},{"type":"text","value":" squares is either empty, marked X, or marked O.\nSo there are ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"akNiHaWXj3"},{"type":"inlineMath","value":"|\\mathcal{S}| = 3^9","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"script\">S</mi><mi mathvariant=\"normal\">∣</mi><mo>=</mo><msup><mn>3</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">|\\mathcal{S}| = 3^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>","key":"QQNHjtXJLd"},{"type":"text","value":" potential states.\nNot all of these may be reachable!","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"wUVoDCuWPd"}],"key":"JdU13baOUv"},{"type":"listItem","spread":true,"position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"The initial state ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"YNS42DJOgX"},{"type":"inlineMath","value":"s_0","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">s_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ObSbKjq9on"},{"type":"text","value":" is the empty board.","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"iHAzSwWy5p"}],"key":"onXPUIdOJ0"},{"type":"listItem","spread":true,"position":{"start":{"line":129,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"The set of possible actions for Max in state ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"lxkMlwPIcV"},{"type":"inlineMath","value":"s","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"CXlXi9QevE"},{"type":"text","value":", ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"lsdMmIP3XS"},{"type":"inlineMath","value":"\\mathcal{A}_{2n}(s)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">A</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{A}_{2n}(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"w77CsOt0OL"},{"type":"text","value":", is the set of tuples ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"sKyCRmHrmK"},{"type":"inlineMath","value":"(\\text{``X''}, i)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mtext>“X”</mtext><mo separator=\"true\">,</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\text{``X&#x27;&#x27;}, i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">“X”</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>","key":"TBSNAND0Pd"},{"type":"text","value":" where ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ZLAm51hhMb"},{"type":"inlineMath","value":"i","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"ylQcf9A9YJ"},{"type":"text","value":" refers to an empty square in ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"YwBgvRvxWp"},{"type":"inlineMath","value":"s","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"bb1uNUkwnO"},{"type":"text","value":".\nSimilarly, ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"tK4rFk3yec"},{"type":"inlineMath","value":"\\mathcal{A}_{2n+1}(s)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">A</mi><mrow><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{A}_{2n+1}(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"khhJ9PIkPV"},{"type":"text","value":" is the set of tuples ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"NiQZLRbVni"},{"type":"inlineMath","value":"(\\text{``O''}, i)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mtext>“O”</mtext><mo separator=\"true\">,</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\text{``O&#x27;&#x27;}, i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">“O”</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>","key":"P0CVqGr1E3"},{"type":"text","value":" where ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"XOJbiGfRLM"},{"type":"inlineMath","value":"i","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"naAvC4vsu0"},{"type":"text","value":" refers to an empty square in ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"GiC098o3ne"},{"type":"inlineMath","value":"s","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"zTZ6sKpw4C"},{"type":"text","value":".","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"te1pMZOPjx"}],"key":"ZqGSerasMw"},{"type":"listItem","spread":true,"position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"We can take ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"pv36EqpO2d"},{"type":"inlineMath","value":"H = 9","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding=\"application/x-tex\">H = 9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9</span></span></span></span>","key":"tjVkkoSofN"},{"type":"text","value":" as the longest possible game length.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"ollbiPdNME"}],"key":"Z0elcEokuN"},{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"inlineMath","value":"P(s, a)","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"HqKjODrrgS"},{"type":"text","value":" for a ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"xxCf4bzYA5"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"nonterminal","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"uVWcHULnnX"}],"key":"dmNmWiWibr"},{"type":"text","value":" state ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"uLBeoG7ijt"},{"type":"inlineMath","value":"s","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"EnUrAUDbyQ"},{"type":"text","value":" is simply the board with the symbol and square specified by ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"dupfwxpx0A"},{"type":"inlineMath","value":"a","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"VWgdMZuZd5"},{"type":"text","value":" marked into ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"dtkpw0Y5eV"},{"type":"inlineMath","value":"s","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"GHYfANNszL"},{"type":"text","value":". Otherwise, if ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"UA8R2Jj6rL"},{"type":"inlineMath","value":"s","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"Qnpz35k0BO"},{"type":"text","value":" is a ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"kIgeoXKUed"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"terminal","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"OSdrb9545V"}],"key":"bq2K0AsJTp"},{"type":"text","value":" state, i.e. it already has three symbols in a row, the state no longer changes.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"htXymPPkNl"}],"key":"vwHlSFhBs2"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"inlineMath","value":"r(s)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"aksH13l4d3"},{"type":"text","value":" at a ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"LcO1nCFVZo"},{"type":"emphasis","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"terminal","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"IJr4PTldja"}],"key":"VRSxOf3K2Q"},{"type":"text","value":" state is ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"ZwFl3xb4wm"},{"type":"text","value":"+1","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"I2nGHExBaQ"},{"type":"text","value":" if there are three Xs in a row, ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"An5kQqtqd9"},{"type":"text","value":"-1","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"zfxewEGNZ9"},{"type":"text","value":" if there are three Os in a row, and ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"g7qMIWgckS"},{"type":"text","value":"0","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"n789OLDvgq"},{"type":"text","value":" otherwise.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"QgjYp07MGH"}],"key":"HI8KnCXLK0"}],"key":"Q1fkn2pUho"}],"enumerator":"1","html_id":"tic-tac-toe","key":"UpVYegO5vY"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"Our notation may remind you of ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"ufcFOV9YvM"},{"type":"link","url":"/mdps","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"Markov decision processes","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"g0vhIcOCHs"}],"urlSource":"./mdps.md","dataUrl":"/mdps.json","internal":true,"protocol":"file","key":"ZWzfqvPxZc"},{"type":"text","value":".\nGiven that these games also involve a sequence of states and actions,\ncan we formulate them as finite-horizon MDPs?\nThe two settings are not exactly analogous,\nsince in MDPs we only consider a ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"xHf2SwPv6T"},{"type":"emphasis","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"single","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"DTj6AGTLUy"}],"key":"TqE5hAXJQs"},{"type":"text","value":" policy,\nwhile these games involve two distinct players with opposite objectives.\nSince we want to analyze the behavior of ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"kapSQMkAOw"},{"type":"emphasis","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"both","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"zqONxIbfVQ"}],"key":"T4mKWnkK3Z"},{"type":"text","value":" players at the same time,\ndescribing such a game as an MDP is more trouble than it’s worth.","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"Xjl86vmmSB"}],"key":"SzBozggbjW"}],"key":"SWeO5qqgUp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Player(IntEnum):\n    EMPTY = 0\n    X = 1\n    O = 2\n\n\nclass TicTacToeEnv(gym.Env):\n    metadata = {\"render.modes\": [\"human\"]}\n\n    def __init__(self):\n        super().__init__()\n        self.action_space = spaces.Discrete(9)\n        self.observation_space = spaces.Box(\n            low=0, high=2, shape=(3, 3), dtype=jnp.int32\n        )\n        self.board = None\n        self.current_player = None\n        self.done = None\n\n    def reset(self, seed=None, options=None):\n        super().reset(seed=seed)\n        self.board = jnp.zeros((3, 3), dtype=jnp.int32)\n        self.current_player = Player.X\n        self.done = False\n        return self.board, {}\n\n    def step(self, action: jnp.int32) -> Int[Array, \"3 3\"]:\n        \"\"\"Take the action a in state s.\"\"\"\n        if self.done:\n            raise ValueError(\"The game is already over. Call `env.reset()` to reset the environment.\")\n        \n        row, col = divmod(action, 3)\n        if self.board[row, col] != Player.EMPTY:\n            return self.board, -10\n        return s.at[row, col].set(player)\n\n    @staticmethod\n    def is_terminal(s: Int[Array, \"3 3\"]):\n        \"\"\"Check if the game is over.\"\"\"\n        return is_winner(s, Player.X) or is_winner(s, Player.O) or jnp.all(s == Player.EMPTY)\n    \n    @staticmethod\n    def is_winner(board: Int[Array, \"3 3\"], player: Player):\n        \"\"\"Check if the given player has won.\"\"\"\n        return any(\n            jnp.all(board[i, :] == player) or\n            jnp.all(board[:, i] == player)\n            for i in range(3)\n        ) or jnp.all(jnp.diag(board) == player) or jnp.all(jnp.diag(jnp.fliplr(board)) == player)\n    \n    @staticmethod\n    def show(s: Int[Array, \"3 3\"]):\n        \"\"\"Print the board.\"\"\"\n        for row in range(3):\n            print(\" | \".join(\" XO\"[s[row, col]] for col in range(3)))\n            if row < 2:\n                print(\"-\" * 5)","key":"WMLX8Gloo1"},{"type":"output","id":"90g4-xWOvIePQNwx_gOnn","data":[],"key":"eaIv6LKvsm"}],"data":{},"key":"LrpWesCt1n"},{"type":"block","children":[],"key":"i0vdhORvjv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"Wbvu5MXxlE"},{"type":"output","id":"sk4MLS-xQ5ZDowBQQdHY9","data":[],"key":"VKbVhFX5YC"}],"data":{},"key":"Bws3qfLZ93"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Min-max search","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"TmFWgBW4ce"}],"label":"min-max-search","identifier":"min-max-search","html_id":"min-max-search","enumerator":"3","key":"aJKFOXRgQJ"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"In the introduction,\nwe claimed that we could win any potentially winnable game by looking ahead and predicting the opponent’s actions.\nThis would mean that each ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"RvhfbDxgcn"},{"type":"emphasis","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"nonterminal","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"UDvfD7TjVb"}],"key":"uE0B6HsQxO"},{"type":"text","value":" state already has some predetermined game score,\nthat is, in each state,\nit is already “obvious” which player is going to win.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"vE5YuNZOZr"}],"key":"JA5MR0v6Ac"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"HWq59O0i0O"},{"type":"inlineMath","value":"V_\\hi^\\star(s)","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V_\\hi^\\star(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0331em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"uNfJqoY2hH"},{"type":"text","value":" denote the game score under optimal play from both players starting in state ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"Ozg3YryKu6"},{"type":"inlineMath","value":"s","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"hWOuyIiVcP"},{"type":"text","value":" at time ","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"yhcMRE7Etq"},{"type":"inlineMath","value":"\\hi","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">\\hi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"bVtuEbNcoO"},{"type":"text","value":".","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"PHDNVehCl2"}],"key":"DTpiZIALrb"},{"type":"proof","kind":"definition","label":"min-max-value","identifier":"min-max-value","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Min-max search algorithm","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"MXQQFw0ukO"}],"key":"vVC9Qb4Jqv"},{"type":"math","value":"V_\\hi^{\\star}(s) = \\begin{cases}\nr(s) & \\hi = \\hor \\\\\n\\max_{a \\in \\mathcal{A}_\\hi(s)} V_{\\hi+1}^{\\star}(P(s, a)) & \\hi \\text{ is even and } \\hi < H \\\\\n\\min_{a \\in \\mathcal{A}_\\hi(s)} V_{\\hi+1}^{\\star}(P(s, a)) & \\hi \\text{ is odd and } \\hi < H \\\\\n\\end{cases}","position":{"start":{"line":223,"column":1},"end":{"line":229,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo lspace=\"0em\" rspace=\"0em\">⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>h</mi><mo>=</mo><mi>H</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>a</mi><mo>∈</mo><msub><mi mathvariant=\"script\">A</mi><mi>h</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></msub><msubsup><mi>V</mi><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><mo lspace=\"0em\" rspace=\"0em\">⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>h</mi><mtext> is even and </mtext><mi>h</mi><mo>&lt;</mo><mi>H</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>a</mi><mo>∈</mo><msub><mi mathvariant=\"script\">A</mi><mi>h</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></msub><msubsup><mi>V</mi><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><mo lspace=\"0em\" rspace=\"0em\">⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>h</mi><mtext> is odd and </mtext><mi>h</mi><mo>&lt;</mo><mi>H</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">V_\\hi^{\\star}(s) = \\begin{cases}\nr(s) &amp; \\hi = \\hor \\\\\n\\max_{a \\in \\mathcal{A}_\\hi(s)} V_{\\hi+1}^{\\star}(P(s, a)) &amp; \\hi \\text{ is even and } \\hi &lt; H \\\\\n\\min_{a \\in \\mathcal{A}_\\hi(s)} V_{\\hi+1}^{\\star}(P(s, a)) &amp; \\hi \\text{ is odd and } \\hi &lt; H \\\\\n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⋆</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.32em;vertical-align:-1.91em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-2.2em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.192em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style=\"top:-4.6em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⋆</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">))</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">min</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⋆</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">))</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"mord text\"><span class=\"mord\"> is even and </span></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"mord text\"><span class=\"mord\"> is odd and </span></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"tVAxtMQp6z"}],"enumerator":"1","html_id":"min-max-value","key":"iUk5eNq4cb"},{"type":"paragraph","position":{"start":{"line":232,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"We can compute this by starting at the terminal states,\nwhen the game’s outcome is known,\nand working backwards,\nassuming that Max chooses the action that leads to the highest score\nand Min chooses the action that leads to the lowest score.","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"OhsJDhWNbO"}],"key":"KmF2oWqBGZ"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"This translates directly into a recursive depth-first search algorithm for searching the complete game tree.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"annMVvLqcF"}],"key":"OE8CejCPob"}],"key":"qDSkr5vkF8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def minimax_search(s, player) -> tuple[\"Action\", \"Value\"]:\n    \"\"\"Return the value of the state (for Max) and the best action for Max to take.\"\"\"\n    if env.is_terminal(s):\n        return None, env.winner(s)\n\n    if player is max:\n        a_max, v_max = None, None\n        for a in env.action_space(s):\n            _, v = minimax_search(env.step(s, a), min)\n            if v > v_max:\n                a_max, v_max = a, v\n        return a_max, v_max\n    else:\n        a_min, v_min = None, None\n        for a in env.action_space(s):\n            _, v = minimax_search(env.step(s, a), max)\n            if v < v_min:\n                a_min, v_min = a, v\n        return a_min, v_min\n\nlatex(minimax_search, custom_identifiers={\"env.step\": \"P\", \"env.action_space\": r\"\\mathcal{A}\"})","key":"IV5Ej3Hsli"},{"type":"output","id":"TUUBKkI0GBCIMNdsft36l","data":[],"key":"dOJyT0zkog"}],"data":{},"key":"X01r2WM97n"},{"type":"block","children":[{"type":"proof","kind":"example","label":"min-max-example","identifier":"min-max-example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Min-max search for a simple game","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"xKuRDMUlOs"}],"key":"lXZYFiRZqX"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Consider a simple game with just two steps: Max chooses one of three possible actions (A, B, C),\nand then Min chooses one of three possible actions (D, E, F).\nThe combination leads to a certain integer outcome,\nshown in the table below:","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"sI89l4XNNE"}],"key":"e9ytg2nmvb"},{"type":"table","position":{"start":{"line":272,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[],"key":"BHniDnbSZw"},{"type":"tableCell","header":true,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"D","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"YNw4BJ0K59"}],"key":"Dx7vVwgFJ2"},{"type":"tableCell","header":true,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"E","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"mwWZNVfiH5"}],"key":"C1eQsciGjP"},{"type":"tableCell","header":true,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"F","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"GQJAWTAXlP"}],"key":"VQCuDIB0nv"}],"key":"o9UcVgx2LA"},{"type":"tableRow","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"A","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"S9RzNd9THR"}],"key":"shZRsEZdXM"},{"type":"tableCell","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"s1Fg8eQmB2"}],"key":"UxC8upzGE1"},{"type":"tableCell","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"-2","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"SHuXXYDudY"}],"key":"wYVWjG9c0s"},{"type":"tableCell","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"j65QS9NIuR"}],"key":"fRIc4b7AKb"}],"key":"ZxhAcLsnVo"},{"type":"tableRow","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"B","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"a7Gz7SYj1V"}],"key":"RI7DUkrMEo"},{"type":"tableCell","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"-3","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"h7zC9EwMCI"}],"key":"kA2QRjHhcb"},{"type":"tableCell","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"PltQoSZ6Rj"}],"key":"kGfiYYWZno"},{"type":"tableCell","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"QL4MM3YM5v"}],"key":"n1opQ3ovhz"}],"key":"xAmLiUjuQQ"},{"type":"tableRow","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"C","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"gZpqXegZAV"}],"key":"O09bHNQfs2"},{"type":"tableCell","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"E5RKErEOdF"}],"key":"nrF1AV9zKB"},{"type":"tableCell","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"uH10Ad8TJK"}],"key":"ePNNFtlXvU"},{"type":"tableCell","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"-1","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"TD4WdkwJZp"}],"key":"euThGkjZzn"}],"key":"uCTdEMyAfN"}],"key":"vgFJNiarvd"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"We can visualize this as the following complete game tree,\nwhere each box contains the value ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"nnEMw6IuvZ"},{"type":"inlineMath","value":"V_\\hi^\\star(s)","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V_\\hi^\\star(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0331em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"iiTxbaLtQz"},{"type":"text","value":" of that node.\nThe min-max values of the terminal states are already known:","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"RVSZpGes6y"}],"key":"n5iLjHnpYO"},{"type":"image","url":"/build/minmax-f71423a6ff8c8c6e4675435aee80055e.png","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"sBxyiT3jhK","urlSource":"./shared/minmax.png","urlOptimized":"/build/minmax-f71423a6ff8c8c6e4675435aee80055e.webp"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"We begin min-max search at the root,\nexploring each of Max’s actions.\nSuppose Max chooses action A.\nThen Min will choose action E to minimize the game score,\nmaking the value of this game node ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"JJWChmesaE"},{"type":"inlineMath","value":"\\min(4, -2, 5) = -2","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>4</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>5</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\min(4, -2, 5) = -2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"Axb16JxgIa"},{"type":"text","value":".","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"PnJBIcxK0f"}],"key":"uMcse4n6eo"},{"type":"image","url":"/build/minmax-2-19b72cc9a0415a25bdb27913738020dc.png","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"hzalyjuuK7","urlSource":"./shared/minmax-2.png","urlOptimized":"/build/minmax-2-19b72cc9a0415a25bdb27913738020dc.webp"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"Similarly, if Max chooses action B,\nthen Min will choose action D,\nand if Max chooses action C,\nthen Min will choose action F.\nWe can fill in the values of these nodes accordingly:","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"F65PXmZHlq"}],"key":"O1V2tU3Inm"},{"type":"image","url":"/build/minmax-3-a9ea540d1a49f7bf3d685801ac664577.png","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"Ft2U6fH6yt","urlSource":"./shared/minmax-3.png","urlOptimized":"/build/minmax-3-a9ea540d1a49f7bf3d685801ac664577.webp"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"Thus, Max’s best move is to take action C,\nresulting in a game score of ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"gNLTbfI5hF"},{"type":"inlineMath","value":"\\max(-2, -3, -1) = -1","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\max(-2, -3, -1) = -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"Aa99HGcNgI"},{"type":"text","value":".","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"voKe3Bv0Qr"}],"key":"jhC0UO7zkS"},{"type":"image","url":"/build/minmax-4-f1c782fe069a198a2b36bbf10d8b2f29.png","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"UuGKKhdq5R","urlSource":"./shared/minmax-4.png","urlOptimized":"/build/minmax-4-f1c782fe069a198a2b36bbf10d8b2f29.webp"}],"enumerator":"2","html_id":"min-max-example","key":"U5v01oCPx4"}],"key":"N1EWYAUuK3"},{"type":"block","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"Complexity of min-max search","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"Bvkl4gOvHd"}],"identifier":"complexity-of-min-max-search","label":"Complexity of min-max search","html_id":"complexity-of-min-max-search","implicit":true,"enumerator":"3.1","key":"Gwa4UBN6Y8"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"At each of the ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"IPMf7jMJES"},{"type":"inlineMath","value":"\\hor","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">\\hor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"fQqLgF54Qf"},{"type":"text","value":" timesteps,\nthis algorithm iterates through the entire action space at that state,\nand therefore has a time complexity of ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"Un57aflJyv"},{"type":"inlineMath","value":"\\hor^{n_A}","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>H</mi><msub><mi>n</mi><mi>A</mi></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\hor^{n_A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"MWubEPROnM"},{"type":"text","value":"\n(where ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"T9NiTM3bac"},{"type":"inlineMath","value":"n_A","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>n</mi><mi>A</mi></msub></mrow><annotation encoding=\"application/x-tex\">n_A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ePDQF1SSLF"},{"type":"text","value":" is the largest number of actions possibly available at once).\nThis makes the min-max algorithm impractical for even moderately sized games.","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"thYpFX4aQZ"}],"key":"zFMVMcOn3N"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"But do we need to compute the exact value of ","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"zFv8WX8lvX"},{"type":"emphasis","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"every","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"zYGKaemAI9"}],"key":"kHEaPWvOmC"},{"type":"text","value":" possible state?\nInstead, is there some way we could “ignore” certain actions and their subtrees\nif we already know of better options?\nThe ","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"cYlpswBnnX"},{"type":"strong","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"alpha-beta search","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"iPDWVg4jQI"}],"key":"iPuVLuYLn8"},{"type":"text","value":" makes use of this intuition.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"psUIgihuM9"}],"key":"Q6K8NJxGIu"}],"key":"qj1146cCIC"},{"type":"block","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Alpha-beta search","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"Xzovlt3zHp"}],"label":"alpha-beta-search","identifier":"alpha-beta-search","html_id":"alpha-beta-search","enumerator":"4","key":"AgcnXSb97s"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"The intuition behind alpha-beta search is as follows:\nSuppose Max is in state ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"ap9zlDE5Mz"},{"type":"inlineMath","value":"s","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"d215NtrlE6"},{"type":"text","value":",\nand considering whether to take action ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"gXXv5z35dt"},{"type":"inlineMath","value":"a","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"gVxMtmmE4A"},{"type":"text","value":" or ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"MVaPPv6PX2"},{"type":"inlineMath","value":"a'","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"mZvXepoCqT"},{"type":"text","value":".\nIf at any point they find out that action ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"z0vDL5ojcW"},{"type":"inlineMath","value":"a'","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"nmFEwGj5QU"},{"type":"text","value":" is definitely worse than (or equal to) action ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"SmZF36jWcJ"},{"type":"inlineMath","value":"a","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"qjomS7usDE"},{"type":"text","value":",\nthey don’t need to evaluate action ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"IqCXe2VSCv"},{"type":"inlineMath","value":"a'","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"oT8Gsy687A"},{"type":"text","value":" any further.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"nrkZH4RcDm"}],"key":"RU0WPFnAWa"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"Concretely, we run min-max search as above,\nexcept now we keep track of two additional parameters ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"xTnLPn0fmE"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"P0bYeG0zlV"},{"type":"text","value":" and ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"nvnpasGWKK"},{"type":"inlineMath","value":"\\beta(s)","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"mUy3gJ8eXy"},{"type":"text","value":" while evaluating each state:","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"wFtryZxtLK"}],"key":"bTt7WqmViq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":335,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"Starting in state ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"w2uaCmVRGK"},{"type":"inlineMath","value":"s","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"xtxKArFzNm"},{"type":"text","value":", Max can achieve a game score of ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"Ql5oBgsJwd"},{"type":"emphasis","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"at least","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"oh2oyLVC45"}],"key":"Wl9gOK4vJG"},{"type":"text","value":" ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"VJ25BUSIlo"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"CeQS8ewZi3"},{"type":"text","value":" assuming Min plays optimally. That is, ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"zDSstM8khQ"},{"type":"inlineMath","value":"V^\\star_\\hi(s) \\ge \\alpha(s)","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>≥</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V^\\star_\\hi(s) \\ge \\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0331em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"gHKsCu4qks"},{"type":"text","value":" at all points.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"DsdvsgifzJ"}],"key":"ZRypxEb8Rv"},{"type":"listItem","spread":true,"position":{"start":{"line":336,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"Analogously, starting in state ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"nH19bwY4Yz"},{"type":"inlineMath","value":"s","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"Mv3MDsmT8K"},{"type":"text","value":", Min can ensure a game score of ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"pGWJrkoUst"},{"type":"emphasis","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"at most","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"B0xtxXGpT5"}],"key":"HLfIcOTlaY"},{"type":"text","value":" ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"GMSoQbeWYk"},{"type":"inlineMath","value":"\\beta(s)","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"HN1bDG6TQW"},{"type":"text","value":" assuming Max plays optimally. That is, ","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"tLoEQmlH1o"},{"type":"inlineMath","value":"V^\\star_\\hi(s) \\le \\beta(s)","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V^\\star_\\hi(s) \\le \\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0331em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"KKoo6mUhoj"},{"type":"text","value":" at all points.","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"DxOKKqLcci"}],"key":"IvcX4PUtEi"}],"key":"Z9FHChTk3w"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"Suppose we are evaluating ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"f0dOsyN9md"},{"type":"inlineMath","value":"V^\\star_\\hi(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V^\\star_\\hi(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0331em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"kwcryjmIPo"},{"type":"text","value":",\nwhere it is Max’s turn (","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"oPBZ3wS4xp"},{"type":"inlineMath","value":"\\hi","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">\\hi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"GKknxiOcop"},{"type":"text","value":" is even).\nWe update ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"rNu5GDeBBX"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"hVmK1G5x2U"},{"type":"text","value":" to be the ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"yhLyjaCGV4"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"highest","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"RhLWuxUBpQ"}],"key":"QLgtUrI6pA"},{"type":"text","value":" minimax value achievable from ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"CkySl8KfBP"},{"type":"inlineMath","value":"s","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"DVwuHyfuVM"},{"type":"text","value":" so far.\nThat is, the value of ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"P1pkIU3iD1"},{"type":"inlineMath","value":"s","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"ERmRXh3aep"},{"type":"text","value":" is ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"x8mr30gHAT"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"at least","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"VVnhjkkNrr"}],"key":"TdFGjnHTNv"},{"type":"text","value":" ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"eNPfMo34by"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"lSdkKgEOQl"},{"type":"text","value":".\nSuppose Max chooses action ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"LdZcWTonpX"},{"type":"inlineMath","value":"a","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"Uv2LFqrEPD"},{"type":"text","value":", which leads to state ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"PfTvZlclbo"},{"type":"inlineMath","value":"s'","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"LCriNbA5oh"},{"type":"text","value":", in which it is Min’s turn.\nIf any of Min’s actions in ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"mUZPzzPaMG"},{"type":"inlineMath","value":"s'","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"FG1WJoFuKD"},{"type":"text","value":" achieve a value ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"G7ni2iiMxo"},{"type":"inlineMath","value":"V^\\star_{\\hi+1}(s') \\le \\alpha(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V^\\star_{\\hi+1}(s&#x27;) \\le \\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0933em;vertical-align:-0.3414em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"QxmMoU2xcD"},{"type":"text","value":",\nwe know that Max would not choose action ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"AXXHeABqBx"},{"type":"inlineMath","value":"a","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"ijkQnF2UvC"},{"type":"text","value":",\nsince they know that it is ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"K922HwPgw8"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"worse","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"WVEMTj7xVb"}],"key":"y1tIHM3SJ6"},{"type":"text","value":" than whichever action gave the value ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"WbToagpTYh"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"B30DnQJvYj"},{"type":"text","value":".\nSimilarly, to evaluate a state on Min’s turn,\nwe update ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"iEmdXJL1yH"},{"type":"inlineMath","value":"\\beta(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"Tk8sk41LFD"},{"type":"text","value":" to be the ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"DgbrZab2Tn"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"lowest","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"SmtIg6I4ww"}],"key":"ZZ2lXiYojz"},{"type":"text","value":" value achievable from ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"F9jWLK9aUQ"},{"type":"inlineMath","value":"s","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"FK3cIFqgyy"},{"type":"text","value":" so far.\nThat is, the value of ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"IgdpppdPJG"},{"type":"inlineMath","value":"s","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"NmgB5JmV39"},{"type":"text","value":" is ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"RBlYjZJqDx"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"at most","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"Iy9H631Cxh"}],"key":"zmysJEFjtf"},{"type":"text","value":" ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"qE7vmLCmhz"},{"type":"inlineMath","value":"\\beta(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"IPLYQNiRLp"},{"type":"text","value":".\nSuppose Min chooses action ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"g878Uh6SFJ"},{"type":"inlineMath","value":"a","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"MXz1k4Aq3Y"},{"type":"text","value":",\nwhich leads to state ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"oiITPSuw76"},{"type":"inlineMath","value":"s'","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"lPGYgq0fyC"},{"type":"text","value":" for Max.\nIf Max has any actions that do ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"EakIyUIjm0"},{"type":"emphasis","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"better","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"AIjx5IgRw9"}],"key":"HSZ5GVnNrL"},{"type":"text","value":" than ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"AruwOKpSxn"},{"type":"inlineMath","value":"\\beta(s)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"Kj9PGeESye"},{"type":"text","value":",\nthey would take it,\nmaking action ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"CbMaQ08eRG"},{"type":"inlineMath","value":"a","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"OefhvjXUfY"},{"type":"text","value":" a suboptimal choice for Min.","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"HVizNDxyFy"}],"key":"VacDkiZShf"},{"type":"proof","kind":"example","label":"alpha-beta-example","identifier":"alpha-beta-example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Alpha-beta search for a simple game","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"YsUGjTjGXs"}],"key":"gxxl9sQ5sH"},{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":362,"column":1}},"children":[{"type":"text","value":"Let us use the same simple game from ","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"opbJ8belJ2"},{"type":"crossReference","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"Example ","key":"JSm0ZNJnJm"},{"type":"text","value":"2","key":"u2jhJjF3SR"}],"identifier":"min-max-example","label":"min-max-example","kind":"proof:example","template":"Example %s","enumerator":"2","resolved":true,"html_id":"min-max-example","key":"ku867f4kMw"},{"type":"text","value":".\nWe list the values of ","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"lXUzl4XVKL"},{"type":"inlineMath","value":"\\alpha(s), \\beta(s)","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s), \\beta(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"SETacQBqc1"},{"type":"text","value":" in each node throughout the algorithm.\nThese values are initialized to ","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"LA5nPjxUjM"},{"type":"inlineMath","value":"-\\infty, +\\infty","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi mathvariant=\"normal\">∞</mi><mo separator=\"true\">,</mo><mo>+</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">-\\infty, +\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">−</span><span class=\"mord\">∞</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">+</span><span class=\"mord\">∞</span></span></span></span>","key":"gFyseAVNDf"},{"type":"text","value":" respectively.\nWe shade any squares that have not been visited by the algorithm,\nand we assume that actions are evaluated from left to right.","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"bxRIKzUun5"}],"key":"yLx2eGg4SX"},{"type":"image","url":"/build/alpha-beta-0-3ca4a9d131e90bf2744271b5eef6d366.png","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"pfbmghYkB9","urlSource":"./shared/alpha-beta-0.png","urlOptimized":"/build/alpha-beta-0-3ca4a9d131e90bf2744271b5eef6d366.webp"},{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Suppose Max takes action A. Let ","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"U14v0NZDfl"},{"type":"inlineMath","value":"s'","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"iHNqEsVnwV"},{"type":"text","value":" be the resulting game state.\nThe values of ","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"XnO7UL85i4"},{"type":"inlineMath","value":"\\alpha(s')","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"bTZ4wO7lgj"},{"type":"text","value":" and ","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"TxarMbfoDG"},{"type":"inlineMath","value":"\\beta(s')","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"bNRnBk6J1B"},{"type":"text","value":"\nare initialized at the same values as the root state,\nsince we want to prune a subtree if there exists a better action at any step higher in the tree.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"j3V6CnAbCk"}],"key":"HLpIjnVdF3"},{"type":"image","url":"/build/alpha-beta-1-7960d044447718824df075813f16f4f8.png","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"zBdYWhQ7kz","urlSource":"./shared/alpha-beta-1.png","urlOptimized":"/build/alpha-beta-1-7960d044447718824df075813f16f4f8.webp"},{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Then we iterate through Min’s possible actions,\nupdating the value of ","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"wJjFabL9hf"},{"type":"inlineMath","value":"\\beta(s')","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Fwu74FTv7j"},{"type":"text","value":" as we go.","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"FKTAyic60h"}],"key":"LNzPDctDan"},{"type":"paragraph","position":{"start":{"line":376,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"image","url":"/build/alpha-beta-2-5d2e676e8998cb6db72750a6e9d66189.png","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"DwAp4MiqCt","urlSource":"./shared/alpha-beta-2.png","urlOptimized":"/build/alpha-beta-2-5d2e676e8998cb6db72750a6e9d66189.webp"},{"type":"text","value":"\n","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"kaNU7tMuPT"},{"type":"image","url":"/build/alpha-beta-3-53025759394165891d8980c682b588a9.png","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"FyKA1N64eo","urlSource":"./shared/alpha-beta-3.png","urlOptimized":"/build/alpha-beta-3-53025759394165891d8980c682b588a9.webp"}],"key":"W2uELlmjuP"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"Once the value of state ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"COesClikE3"},{"type":"inlineMath","value":"s'","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"vDmPw96SVH"},{"type":"text","value":" is fully evaluated,\nwe know that Max can achieve a value of ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"kV5CN7Z64A"},{"type":"emphasis","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"at least","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"phxBHWnkfn"}],"key":"f0VOGnMqO6"},{"type":"text","value":" ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"sERYkEwarU"},{"type":"text","value":"-2","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"jYOrjPXdbQ"},{"type":"text","value":" starting from the root,\nand so we update ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"TIYwBUuFoo"},{"type":"inlineMath","value":"\\alpha(s)","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"QAeuk5fATt"},{"type":"text","value":", where ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"ndNPxcgLZo"},{"type":"inlineMath","value":"s","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"RLczOMxiXF"},{"type":"text","value":" is the root state:","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"HwqumupvJk"}],"key":"VDCwasqed0"},{"type":"image","url":"/build/alpha-beta-4-0ebd33da9e75e1601819861369fac0d0.png","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"vOr2voEnEu","urlSource":"./shared/alpha-beta-4.png","urlOptimized":"/build/alpha-beta-4-0ebd33da9e75e1601819861369fac0d0.webp"},{"type":"paragraph","position":{"start":{"line":385,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"Then Max imagines taking action B. Again, let ","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"oSED7vGjXZ"},{"type":"inlineMath","value":"s'","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"iwiZDbDzu2"},{"type":"text","value":" denote the resulting game state.\nWe initialize ","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"fVlTmP6dxP"},{"type":"inlineMath","value":"\\alpha(s')","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(s&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ryW5nzTvkm"},{"type":"text","value":" and ","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"LS5OySFq7R"},{"type":"inlineMath","value":"\\beta(s')","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta(s&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"qWpLrTX4gN"},{"type":"text","value":" from the root:","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"VujXxM5u7Z"}],"key":"a1Ab71A9Il"},{"type":"image","url":"/build/alpha-beta-5-afd518d432be2dab0a96efa8374febf5.png","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"pNobmxi45H","urlSource":"./shared/alpha-beta-5.png","urlOptimized":"/build/alpha-beta-5-afd518d432be2dab0a96efa8374febf5.webp"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"text","value":"Now suppose Min takes action D, resulting in a value of ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"CB1Gi7wqYw"},{"type":"text","value":"-3","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"U6CIRWDSIC"},{"type":"text","value":".\nWe see that ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"k1vPaPWIjE"},{"type":"inlineMath","value":"V^\\star_\\hi(s') = \\min(-3, x, y)","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>V</mi><mi>h</mi><mo>⋆</mo></msubsup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">V^\\star_\\hi(s&#x27;) = \\min(-3, x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.035em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">⋆</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"RpYhNae5YP"},{"type":"text","value":",\nwhere ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"obttR8XgVX"},{"type":"inlineMath","value":"x","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"qsrd6dN2fT"},{"type":"text","value":" and ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"ngJRwZdkkC"},{"type":"inlineMath","value":"y","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"HhBZkxY78x"},{"type":"text","value":" are the values of the remaining two actions.\nBut since ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"dEoxWhqLyE"},{"type":"inlineMath","value":"\\min(-3, x, y) \\le -3","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mo>−</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">\\min(-3, x, y) \\le -3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">3</span></span></span></span>","key":"qe1roUT2bN"},{"type":"text","value":",\nwe know that the value of ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"z1xlmQvbo8"},{"type":"inlineMath","value":"s'","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">s&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"jDSyTLraL0"},{"type":"text","value":" is at most ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"LFUZoR6WB2"},{"type":"text","value":"-3","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"lDOveIS8Um"},{"type":"text","value":".\nBut Max can achieve a better value of ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"r9PzRQv0Bx"},{"type":"inlineMath","value":"\\alpha(s') = -2","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\alpha(s&#x27;) = -2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span>","key":"VEo4WnSL6A"},{"type":"text","value":" by taking action A,\nand so Max will never take action B,\nand we can prune the search here.\nWe will use dotted lines to indicate states that have been ruled out from the search:","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"yCqXbz5kBL"}],"key":"lpcmr2a3YV"},{"type":"image","url":"/build/alpha-beta-6-9c2fd67309ecdb701aabe44e065ece71.png","position":{"start":{"line":400,"column":1},"end":{"line":400,"column":1}},"key":"jInrm7oRbW","urlSource":"./shared/alpha-beta-6.png","urlOptimized":"/build/alpha-beta-6-9c2fd67309ecdb701aabe44e065ece71.webp"},{"type":"paragraph","position":{"start":{"line":402,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"Finally, suppose Max takes action C.\nFor Min’s actions D and E,\nthere is still a chance that action C might outperform action A,\nso we continue expanding:","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"VyR4vslPzt"}],"key":"LGIqEof5xS"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"image","url":"/build/alpha-beta-7-5dc2890339a30cf49143a81942bec5c6.png","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"YXEseLO2g1","urlSource":"./shared/alpha-beta-7.png","urlOptimized":"/build/alpha-beta-7-5dc2890339a30cf49143a81942bec5c6.webp"},{"type":"text","value":"\n","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"wp4vyiGCGo"},{"type":"image","url":"/build/alpha-beta-8-915ba3c37e09717420ca0f2716b4f2fe.png","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"FR36Tqsagx","urlSource":"./shared/alpha-beta-8.png","urlOptimized":"/build/alpha-beta-8-915ba3c37e09717420ca0f2716b4f2fe.webp"}],"key":"hYR8H9wRIR"},{"type":"paragraph","position":{"start":{"line":410,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"Finally, we see that Min taking action F achieves the minimum value at this state.\nThis shows that optimal play is for Max to take action C,\nand Min to take action F.","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"ABH3gUz8vF"}],"key":"aXkexmYhuc"},{"type":"image","url":"/build/alpha-beta-9-c3f62eef335628f0072c8b89ab10d96d.png","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"jDXjCFk9RI","urlSource":"./shared/alpha-beta-9.png","urlOptimized":"/build/alpha-beta-9-c3f62eef335628f0072c8b89ab10d96d.webp"}],"enumerator":"3","html_id":"alpha-beta-example","key":"PhNG9LPnGp"}],"key":"kGSeMfJxNo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def alpha_beta_search(s, player, alpha, beta) -> tuple[\"Action\", \"Value\"]:\n    \"\"\"Return the value of the state (for Max) and the best action for Max to take.\"\"\"\n    if env.is_terminal(s):\n        return None, env.winner(s)\n\n    if player is max:\n        a_max, v_max = None, None\n        for a in actions:\n            _, v = minimax_search(env.step(s, a), min, alpha, beta)\n            if v > v_max:\n                a_max, v_max = a, v\n                alpha = max(alpha, v)\n            if v_max >= beta:\n                # we know Min will not choose the action that leads to this state\n                return a_max, v_max\n        return a_max, v_max\n\n    else:\n        a_min, v_min = None, None\n        for a in actions:\n            _, v = minimax_search(env.step(s, a), max)\n            if v < v_min:\n                a_min, v_min = a, v\n                beta = min(beta, v)\n            if v_min <= alpha:\n                # we know Max will not choose the action that leads to this state\n                return a_min, v_min\n        return a_min, v_min\n\n\nlatex(alpha_beta_search)","key":"nIERmsqyEz"},{"type":"output","id":"bBFTu7MI3KtCNGYpmtbAd","data":[],"key":"HhqxO5bk2Z"}],"data":{},"key":"FySoX23KBM"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":461,"column":1}},"children":[{"type":"text","value":"How do we choose what ","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"y26mOFsQb9"},{"type":"emphasis","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"order","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"M13Qta7zae"}],"key":"tdDbyQD6t9"},{"type":"text","value":" to explore the branches?\nAs you can tell, this significantly affects the efficiency of the pruning algorithm.\nIf Max explores the possible actions in order from worst to best,\nthey will not be able to prune any branches at all!\nAdditionally, to verify that an action is suboptimal,\nwe must run the search recursively from that action,\nwhich ultimately requires traversing the tree all the way to a leaf node.\nThe longer the game might possibly last,\nthe more computation we have to run.","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"jYwZPxjW9Y"}],"key":"oqhxKfCHuQ"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":466,"column":1}},"children":[{"type":"text","value":"In practice, we can often use background information about the game to develop a ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"HXpxhMO3xf"},{"type":"strong","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"heuristic","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"kkhD2ktkAs"}],"key":"BdFRqo57AY"},{"type":"text","value":" for evaluating possible actions.\nIf a technique is based on background information or intuition,\nespecially if it isn’t rigorously justified,\nwe call it a heuristic.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"u9UyvxCms2"}],"key":"nTRabQhC0L"},{"type":"paragraph","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"Can we develop ","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"uw2pgVSkll"},{"type":"emphasis","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"heuristic methods","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"EIYhnU6Dbp"}],"key":"WTeXzR83jx"},{"type":"text","value":" for tree exploration that works for all sorts of games?","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"zBQ3uqLMah"}],"key":"prtZSBwOoK"},{"type":"comment","value":" Here's where we can incorporate the _reinforcement learning_ ","key":"plE76pfNSf"}],"key":"pjlK2iYFfL"},{"type":"block","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"children":[{"type":"text","value":"Monte Carlo Tree Search","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":1}},"key":"AfdTMfmmcX"}],"label":"monte-carlo-tree-search","identifier":"monte-carlo-tree-search","html_id":"monte-carlo-tree-search","enumerator":"5","key":"ZY79CnEqP4"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"The task of evaluating actions in a complex environment might seem familiar.\nWe’ve encountered this problem before in both the ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"ZUOINO2Ops"},{"type":"link","url":"/bandits","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"multi-armed bandits","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"gHQXehhQiY"}],"urlSource":"./bandits.md","dataUrl":"/bandits.json","internal":true,"protocol":"file","key":"sOcj0PLUll"},{"type":"text","value":" setting and the ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"qbh7XJwsUy"},{"type":"link","url":"/mdps","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"Markov decision process","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"Gy0WGvmztz"}],"urlSource":"./mdps.md","dataUrl":"/mdps.json","internal":true,"protocol":"file","key":"ELQGJSrglh"},{"type":"text","value":" setting.\nNow we’ll see how to combine concepts from these to form a more general and efficient tree search heuristic called ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"bHDCkattNb"},{"type":"strong","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"Monte Carlo Tree Search","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"EGhuqcAjsf"}],"key":"hitGAZks2O"},{"type":"text","value":" (MCTS).","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"Z7zFcwpL1c"}],"key":"xtdjzJWZhE"},{"type":"paragraph","position":{"start":{"line":480,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"When a problem is intractable to solve ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"Z6jexlNY7m"},{"type":"emphasis","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"TY6bf5EmEq"}],"key":"s0wllvjskC"},{"type":"text","value":",\nwe often turn to ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"aOeyPG79xB"},{"type":"emphasis","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"approximate","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"S6hLQDh7wJ"}],"key":"DJI4UL3U11"},{"type":"text","value":" algorithms that sacrifice some accuracy in exchange for computational efficiency.\nMCTS also improves on alpha-beta search in this sense.\nAs the name suggests,\nMCTS uses ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"oKPifjgfMB"},{"type":"emphasis","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"Monte Carlo","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"iV0YpAkurL"}],"key":"GCyzCT7Ztj"},{"type":"text","value":" simulation, that is, collecting random samples and computing the sample statistics,\nin order to ","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"gDmBa3FlB4"},{"type":"emphasis","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"children":[{"type":"text","value":"approximate","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"AujshifS1y"}],"key":"QUZCcoKBH2"},{"type":"text","value":" the value of each action.","position":{"start":{"line":480,"column":1},"end":{"line":480,"column":1}},"key":"UAh6ZKLiwE"}],"key":"y6Z9p7bXLt"},{"type":"paragraph","position":{"start":{"line":487,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"text","value":"As before, we imagine a complete game tree in which each path represents an ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"AKqohCrUUB"},{"type":"emphasis","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"entire game","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"M8PNVWOZku"}],"key":"ViAulcWiYI"},{"type":"text","value":".\nThe goal of MCTS is to assign values to only the game states that are ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"lsZmUWf2aE"},{"type":"emphasis","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"relevant","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"ran7TdAKJ3"}],"key":"oEg7n4lMRe"},{"type":"text","value":" to the ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"RYc7AiPleX"},{"type":"emphasis","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"current game","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"q2CsBSTIxU"}],"key":"TqGd6gkA31"},{"type":"text","value":";\nWe gradually expand the tree at each move.\nFor comparison, in alpha-beta search,\nthe entire tree only needs to be solved ","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"euR9VFf0dY"},{"type":"emphasis","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"children":[{"type":"text","value":"once","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"jqHCQfbdEp"}],"key":"QfimOhONzP"},{"type":"text","value":",\nand from then on,\nchoosing an action is as simple as taking a maximum over the previously computed values.","position":{"start":{"line":487,"column":1},"end":{"line":487,"column":1}},"key":"XQHNQtj18X"}],"key":"vt83XTfvuo"},{"type":"paragraph","position":{"start":{"line":495,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"The crux of MCTS is approximating the win probability of a state by a ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"HxVsqavhAK"},{"type":"emphasis","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"sample probability","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"QDDfYILHSL"}],"key":"RQzd7Ve2TO"},{"type":"text","value":".\nIn practice, MCTS is used for games with ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"kvyVztaH91"},{"type":"emphasis","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"binary outcomes","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"v58bnCHyHb"}],"key":"EesZA6qviC"},{"type":"text","value":" where ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"g7TSK0ab7S"},{"type":"inlineMath","value":"r(s) \\in \\{ +1, -1 \\}","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mo stretchy=\"false\">{</mo><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">r(s) \\in \\{ +1, -1 \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">+</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>","key":"unRkVStTSQ"},{"type":"text","value":",\nand so this is equivalent to approximating the final game score.\nTo approximate the win probability from state ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"FySGx8O8Nl"},{"type":"inlineMath","value":"s","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"GzpOAF6WXx"},{"type":"text","value":",\nMCTS samples random games starting in ","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"YqSWA1rlRn"},{"type":"inlineMath","value":"s","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"ksiKQ7aEbH"},{"type":"text","value":" and computes the sample proportion of those that the player wins.","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"d6WNzChksv"}],"key":"xT0wA1ndaX"},{"type":"paragraph","position":{"start":{"line":501,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"Note that, for a given state ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"w0ciSDpHUP"},{"type":"inlineMath","value":"s","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"UQBvQllDWy"},{"type":"text","value":",\nchoosing the best action ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"VeUkuiwxEU"},{"type":"inlineMath","value":"a","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"lK0XwchWHT"},{"type":"text","value":" can be framed as a ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"qCwOyzn32S"},{"type":"link","url":"/bandits","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"multi-armed bandits","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"WYLI8ZGYSd"}],"urlSource":"./bandits.md","dataUrl":"/bandits.json","internal":true,"protocol":"file","key":"IjJICFvSro"},{"type":"text","value":" problem,\nwhere each action corresponds to an arm,\nand the reward distribution of arm ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"tVseEcwyM5"},{"type":"inlineMath","value":"k","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"VKDhLoal4X"},{"type":"text","value":" is the distribution of the game score over random games after choosing that arm.\nThe most commonly used bandit algorithm in practice for MCTS is the ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"Y1OtK5pm4z"},{"type":"crossReference","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"Upper Confidence Bound (UCB)","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"key":"DViCLfuGtE"}],"identifier":"ucb","label":"ucb","kind":"heading","template":"Section %s","enumerator":"3.6","resolved":true,"html_id":"ucb","remote":true,"url":"/bandits","dataUrl":"/bandits.json","key":"vFigvOQjow"},{"type":"text","value":" algorithm.","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"SpQw4AgHz6"}],"key":"nFSmPfOTtA"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Summary of UCB","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"UmcgSsWW0u"}],"key":"Gr6hfIBU0S"},{"type":"paragraph","position":{"start":{"line":508,"column":1},"end":{"line":520,"column":1}},"children":[{"type":"text","value":"Let us quickly review the UCB bandit algorithm.\nFor each arm ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"YTPpFzsir4"},{"type":"inlineMath","value":"k","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"hZGyJLMbLV"},{"type":"text","value":", we track the sample mean","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"epfWZh9GSq"}],"key":"XSKdWaY3a1"},{"type":"math","value":"\\hat \\mu^k_t = \\frac{1}{N_t^k} \\sum_{\\tau=0}^{t-1} \\ind{a_\\tau = k} r_\\tau","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mover accent=\"true\"><mi>μ</mi><mo>^</mo></mover><mi>t</mi><mi>k</mi></msubsup><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>N</mi><mi>t</mi><mi>k</mi></msubsup></mfrac><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></munderover><mn mathvariant=\"bold\">1</mn><mrow><mo fence=\"true\">{</mo><msub><mi>a</mi><mi>τ</mi></msub><mo>=</mo><mi>k</mi><mo fence=\"true\">}</mo></mrow><msub><mi>r</mi><mi>τ</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat \\mu^k_t = \\frac{1}{N_t^k} \\sum_{\\tau=0}^{t-1} \\ind{a_\\tau = k} r_\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0682em;vertical-align:-1.2671em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2791em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8309em;\"><span style=\"top:-2.4542em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2458em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9667em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8011em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose delimcenter\" style=\"top:0em;\">}</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"qSJQ2xzDvd"},{"type":"paragraph","position":{"start":{"line":508,"column":1},"end":{"line":520,"column":1}},"children":[{"type":"text","value":"of all rewards from that arm up to time ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"ty3pYcWhbM"},{"type":"inlineMath","value":"t","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"Ygz6N0OIfd"},{"type":"text","value":".\nThen we construct a ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"QRtPy9MjAs"},{"type":"emphasis","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"children":[{"type":"text","value":"confidence interval","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"GXigGNGwsc"}],"key":"CYEXrHfuet"},{"type":"text","value":"","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"INvvrmSwp9"}],"key":"mZzbITZD0f"},{"type":"math","value":"C_t^k = [\\hat \\mu^k_t - B_t^k, \\hat \\mu^k_t + B_t^k],","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>C</mi><mi>t</mi><mi>k</mi></msubsup><mo>=</mo><mo stretchy=\"false\">[</mo><msubsup><mover accent=\"true\"><mi>μ</mi><mo>^</mo></mover><mi>t</mi><mi>k</mi></msubsup><mo>−</mo><msubsup><mi>B</mi><mi>t</mi><mi>k</mi></msubsup><mo separator=\"true\">,</mo><msubsup><mover accent=\"true\"><mi>μ</mi><mo>^</mo></mover><mi>t</mi><mi>k</mi></msubsup><mo>+</mo><msubsup><mi>B</mi><mi>t</mi><mi>k</mi></msubsup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">C_t^k = [\\hat \\mu^k_t - B_t^k, \\hat \\mu^k_t + B_t^k],</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"3","key":"EsXsRIrxmW"},{"type":"paragraph","position":{"start":{"line":508,"column":1},"end":{"line":520,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"hoCrHl2Ydp"},{"type":"inlineMath","value":"B_t^k = \\sqrt{\\frac{\\ln(2 t / \\delta)}{2 N_t^k}}","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>B</mi><mi>t</mi><mi>k</mi></msubsup><mo>=</mo><msqrt><mfrac><mrow><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>t</mi><mi mathvariant=\"normal\">/</mi><mi>δ</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mn>2</mn><msubsup><mi>N</mi><mi>t</mi><mi>k</mi></msubsup></mrow></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">B_t^k = \\sqrt{\\frac{\\ln(2 t / \\delta)}{2 N_t^k}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0961em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.453em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.84em;vertical-align:-0.651em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.189em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.6014em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8408em;\"><span style=\"top:-2.2095em;margin-left:-0.109em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2905em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">n</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mtight\">/</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.602em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.149em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.651em;\"><span></span></span></span></span></span></span></span></span>","key":"YTBWfbQiXd"},{"type":"text","value":" is given by Hoeffding’s inequality,\nso that with probability ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"AuRDIWPGIa"},{"type":"text","value":"δ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"BZnpja5rFL"},{"type":"text","value":" (some fixed parameter we choose),\nthe true mean ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"AJUa7kbQQX"},{"type":"inlineMath","value":"\\mu^k","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>μ</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mu^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0435em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"Jq9YW3ongd"},{"type":"text","value":" lies within ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"kb0YvL2KrB"},{"type":"inlineMath","value":"C_t^k","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>C</mi><mi>t</mi><mi>k</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">C_t^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0961em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tWDcv1pxy4"},{"type":"text","value":".\nNote that ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"u5CzYH3AOt"},{"type":"inlineMath","value":"B_t^k","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>B</mi><mi>t</mi><mi>k</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">B_t^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0961em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.453em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nIGYlaz67N"},{"type":"text","value":" scales like ","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"NRgliGtUaW"},{"type":"inlineMath","value":"\\sqrt{1/N^k_t}","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><msubsup><mi>N</mi><mi>t</mi><mi>k</mi></msubsup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{1/N^k_t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.2645em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9755em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8309em;\"><span style=\"top:-2.4542em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2458em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.9355em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2645em;\"><span></span></span></span></span></span></span></span></span>","key":"QqeRDDUQcG"},{"type":"text","value":",\ni.e. the more we have visited that arm,\nthe more confident we get about it,\nand the narrower the confidence interval.","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"S3QsPrUoGA"}],"key":"yw765PVdFO"},{"type":"paragraph","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"children":[{"type":"text","value":"To select an arm, we pick the arm with the highest ","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"NtVDf0AjsQ"},{"type":"emphasis","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"children":[{"type":"text","value":"upper confidence bound","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"rMPri6vbQn"}],"key":"OZSiTl2P9i"},{"type":"text","value":".","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"GgjTjqH9iP"}],"key":"HsF3lOMvmq"}],"key":"ZVrHSE7vdM"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"This means that, for each edge (corresponding to a state-action pair ","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"Y30htfsn42"},{"type":"inlineMath","value":"(s, a)","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"CitEm1cqTk"},{"type":"text","value":") in the game tree,\nwe keep track of the statistics required to compute its UCB:","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"GQyG0J3Au3"}],"key":"M8ATJvSe7d"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":528,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"How many times it has been “visited” (","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"i7lKpoIS1G"},{"type":"inlineMath","value":"N_t^{s, a}","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>N</mi><mi>t</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">N_t^{s, a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0281em;vertical-align:-0.2458em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4542em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2458em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pnxJSJoh6g"},{"type":"text","value":")","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"OD70N8g0r3"}],"key":"HJM6OTiJGT"},{"type":"listItem","spread":true,"position":{"start":{"line":529,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"text","value":"How many of those visits resulted in victory (","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"eYlTeEgSQv"},{"type":"inlineMath","value":"\\sum_{\\tau=0}^{t-1} \\ind{(s_\\tau, a_\\tau) = (s, a)} r_\\tau","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mn mathvariant=\"bold\">1</mn><mrow><mo fence=\"true\">{</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>τ</mi></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>τ</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">}</mo></mrow><msub><mi>r</mi><mi>τ</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\sum_{\\tau=0}^{t-1} \\ind{(s_\\tau, a_\\tau) = (s, a)} r_\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2537em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">{</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">}</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BqtTu37pcf"},{"type":"text","value":").\nLet us call this latter value ","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"nHxZvgM8L6"},{"type":"inlineMath","value":"W^{s, a}_t","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>W</mi><mi>t</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">W^{s, a}_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0281em;vertical-align:-0.2458em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7823em;\"><span style=\"top:-2.4542em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2458em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dE61H3E0Ab"},{"type":"text","value":" (for number of “wins”).","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"ek6XzVvKoW"}],"key":"Ru5lV3Nn8A"}],"key":"CXdmpBItUy"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"What does ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"AN2lCERFMn"},{"type":"inlineMath","value":"t","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"Mw7p02E3gf"},{"type":"text","value":" refer to in the above expressions?\nRecall ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"mYCR2RExGq"},{"type":"inlineMath","value":"t","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"zaJIbeMJ4z"},{"type":"text","value":" refers to the number of time steps elapsed in the ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"RWN8dSvqu2"},{"type":"emphasis","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"bandit environment","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"vq47xnKWpd"}],"key":"QRgUdKV2c7"},{"type":"text","value":".\nAs mentioned above,\neach state ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"n8EsaNXErx"},{"type":"inlineMath","value":"s","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"HkBoDAGQrw"},{"type":"text","value":" corresponds to its own bandit environment,\nand so ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"Q3LcbXf5i2"},{"type":"inlineMath","value":"t","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"sGT3O99B3i"},{"type":"text","value":" refers to ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"ezaOSqcPHo"},{"type":"inlineMath","value":"N^s","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>s</mi></msup></mrow><annotation encoding=\"application/x-tex\">N^s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span></span>","key":"ORdFVvncKl"},{"type":"text","value":", that is,\nhow many actions have been taken from state ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"oVzsFqTjem"},{"type":"inlineMath","value":"s","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"NcmylhlrkU"},{"type":"text","value":".\nThis term, ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"fs0lGjlLbC"},{"type":"inlineMath","value":"N^s","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>s</mi></msup></mrow><annotation encoding=\"application/x-tex\">N^s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span></span>","key":"bBGVRDXdVR"},{"type":"text","value":", gets incremented as the algorithm runs;\nfor simplicity, we won’t introduce another index to track how it changes.","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"qfkcnpNN1r"}],"key":"TEcUroE8yd"},{"type":"proof","kind":"algorithm","label":"mcts-algorithm","identifier":"mcts-algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Monte Carlo tree search algorithm","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"zhh37g4ewb"}],"key":"OpvQe1Rl5O"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"Inputs:","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"phmHyTNcZE"}],"key":"FaqnTwADis"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":545,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"inlineMath","value":"T","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"Q9FnHcsjQF"},{"type":"text","value":", the number of iterations per move","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"SvkqIEJpvk"}],"key":"fEBQ8W7MOU"},{"type":"listItem","spread":true,"position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"inlineMath","value":"\\pi_{\\text{rollout}}","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>rollout</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_{\\text{rollout}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">rollout</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LokCdiPZyT"},{"type":"text","value":", the ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"SNSoy9cnj0"},{"type":"strong","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"rollout policy","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"FnYAlip37e"}],"key":"aIsppDWpHs"},{"type":"text","value":" for randomly sampling games","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"V7yFWixit7"}],"key":"dpZa2FygcE"},{"type":"listItem","spread":true,"position":{"start":{"line":547,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"inlineMath","value":"c","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"Gk4ZlZcM30"},{"type":"text","value":", a positive value that encourages exploration","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"key":"fLqSEC8VRR"}],"key":"kg8cNFhT9p"}],"key":"UjrPvEyfyt"},{"type":"paragraph","position":{"start":{"line":549,"column":1},"end":{"line":553,"column":1}},"children":[{"type":"text","value":"To choose a single move starting at state ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"aLI3BiwlOB"},{"type":"inlineMath","value":"s_{\\text{start}}","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>start</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_{\\text{start}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">start</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ntv2boFxkW"},{"type":"text","value":",\nMCTS first tries to estimate the UCB values for each of the possible actions ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"ZQajhOqQ6r"},{"type":"inlineMath","value":"\\mathcal{A}(s_\\text{start})","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">A</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mtext>start</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{A}(s_\\text{start})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">start</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"UQGFdFWwgs"},{"type":"text","value":",\nand then chooses the best one.\nTo estimate the UCB values,\nit repeats the following four steps ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"Ft16TOS5ti"},{"type":"inlineMath","value":"T","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"D5qV8bpODk"},{"type":"text","value":" times:","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"KwbIrzTYmG"}],"key":"ikKiUqL2Bb"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":555,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":555,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"strong","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"children":[{"type":"text","value":"Selection","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"ZQopY7Jiy4"}],"key":"aCihWa3Oe9"},{"type":"text","value":": We start at ","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"EZaU3dBs9N"},{"type":"inlineMath","value":"s = s_{\\text{start}}","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><msub><mi>s</mi><mtext>start</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s = s_{\\text{start}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">start</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yBojuXqGnd"},{"type":"text","value":". Let ","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"I4pTnMnlYK"},{"type":"text","value":"τ","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"L9cw17VTRh"},{"type":"text","value":" be an empty list that we will use to track states and actions.","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"OqLphwz1c0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":556,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":556,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"Until ","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"HZbsGC1VcQ"},{"type":"inlineMath","value":"s","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"bXlLu2czfn"},{"type":"text","value":" has at least one action that hasn’t been taken:","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"tdrBoB8MlM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":557,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":557,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"text","value":"Choose ","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"cC86QkoFGL"},{"type":"inlineMath","value":"a \\gets \\argmax_k \\text{UCB}^{s, k}","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>←</mo><msub><mrow><mi mathvariant=\"normal\">arg max</mi><mo>⁡</mo></mrow><mi>k</mi></msub><msup><mtext>UCB</mtext><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">a \\gets \\argmax_k \\text{UCB}^{s, k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1665em;vertical-align:-0.2441em;\"></span><span class=\"mop\"><span class=\"mop\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">arg</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathrm\">max</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.242em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">UCB</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9223em;\"><span style=\"top:-3.1362em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span></span>","key":"lY3IxM7xXb"},{"type":"text","value":", where\n","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"JyMSD6jm7U"},{"type":"math","value":"\\text{UCB}^{s, a} = \\frac{W^{s, a}}{N^{s, a}} + c \\sqrt{\\frac{\\ln N^s}{N^{s, a}}}","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"identifier":"ucb-tree","label":"ucb-tree","html_id":"ucb-tree","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mtext>UCB</mtext><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>=</mo><mfrac><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup></mfrac><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>⁡</mo><msup><mi>N</mi><mi>s</mi></msup></mrow><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">\\text{UCB}^{s, a} = \\frac{W^{s, a}}{N^{s, a}} + c \\sqrt{\\frac{\\ln N^s}{N^{s, a}}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7376em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">UCB</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7376em;\"><span style=\"top:-3.1362em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7634em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6766em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6366em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7634em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"MLOQbSCFo1"}],"key":"l8qySeNSqf"},{"type":"listItem","spread":true,"position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"children":[{"type":"text","value":"Append ","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"w5HJEmCCF9"},{"type":"inlineMath","value":"(s, a)","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"w3noSn7zaS"},{"type":"text","value":" to ","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"n0s2v8vRon"},{"type":"text","value":"τ","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"Va4DQkQ9oV"}],"key":"vsKEj4MAOK"},{"type":"listItem","spread":true,"position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"zLD9YF7zaa"},{"type":"inlineMath","value":"s \\gets P(s, a)","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>←</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s \\gets P(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"lzCyqg99g1"}],"key":"DU4KVLdTx2"}],"key":"KAXkItAmHs"}],"key":"alZPaxEcA7"}],"key":"KwZ5srhEmN"}],"key":"uXicpLAqMz"},{"type":"listItem","spread":true,"position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"strong","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Expansion","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"YYMN1FTSi9"}],"key":"S4hp2DJfx3"},{"type":"text","value":": Let ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"e2uqCUbb0V"},{"type":"inlineMath","value":"s_\\text{new}","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_\\text{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"oTinKRTUo7"},{"type":"text","value":" denote the final state in ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"YBj66YMZaY"},{"type":"text","value":"τ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"pVDKktr4Pb"},{"type":"text","value":" (that has at least one action that hasn’t been taken). Choose one of these unexplored actions from ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"tWKq5QB57G"},{"type":"inlineMath","value":"s_\\text{new}","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_\\text{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IgPcTppN5l"},{"type":"text","value":". Call it ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"XzgVN8ueCl"},{"type":"inlineMath","value":"a_{\\text{new}}","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">a_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AXh59LfNoX"},{"type":"text","value":". Add it to ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"nRCAVmUEcl"},{"type":"text","value":"τ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"xgHfkkuaJc"},{"type":"text","value":".","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"oz5NBZe3nG"}],"key":"xzkVecyAUH"},{"type":"listItem","spread":true,"position":{"start":{"line":565,"column":1},"end":{"line":567,"column":1}},"children":[{"type":"strong","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"children":[{"type":"text","value":"Simulation","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"dpn6I7RZcm"}],"key":"wNow7q6qwo"},{"type":"text","value":": Simulate a complete game episode by starting with the action ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"UXMvdYrJDa"},{"type":"inlineMath","value":"a_{\\text{new}}","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">a_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AiFxFVlDA3"},{"type":"text","value":"\nand then playing according to ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"XHQU0v1aaP"},{"type":"inlineMath","value":"\\pi_\\text{rollout}","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>rollout</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{rollout}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">rollout</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kx7qxnNiqj"},{"type":"text","value":".\nThis results in the outcome ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"z5O8tGNFWo"},{"type":"inlineMath","value":"r \\in \\{ +1, -1 \\}","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy=\"false\">{</mo><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">r \\in \\{ +1, -1 \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">+</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>","key":"H9Bcmgn6Da"},{"type":"text","value":".","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"Se9oljapIQ"}],"key":"YIsI10YN1i"},{"type":"listItem","spread":true,"position":{"start":{"line":568,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"strong","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"text","value":"Backup","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"kM94gV59cC"}],"key":"DObTt61dG7"},{"type":"text","value":": For each ","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"IE4xlUJTPv"},{"type":"inlineMath","value":"(s, a) \\in \\tau","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">(s, a) \\in \\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"idGCdolthJ"},{"type":"text","value":":","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"NG8MEsDnOq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":569,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"mosF11lzET"},{"type":"inlineMath","value":"N^{s, a} \\gets N^{s, a} + 1","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>←</mo><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N^{s, a} \\gets N^{s, a} + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"lnj0Vo1ATG"}],"key":"Qxq8f6q4ln"},{"type":"listItem","spread":true,"position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"inlineMath","value":"W^{s, a} \\gets W^{s, a} + r","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>←</mo><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>+</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">W^{s, a} \\gets W^{s, a} + r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"eMf69IA283"}],"key":"aQVGm2vMDU"},{"type":"listItem","spread":true,"position":{"start":{"line":571,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"qmvgvB9671"},{"type":"inlineMath","value":"N^s \\gets N^s + 1","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>s</mi></msup><mo>←</mo><msup><mi>N</mi><mi>s</mi></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N^s \\gets N^s + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"TlQYqBH55s"}],"key":"JckSBBm6pL"}],"key":"rpoYP8uqfn"}],"key":"wWN10OXljz"}],"key":"SeUh6EbvIh"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"After ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"Qfh0AVgSLM"},{"type":"inlineMath","value":"T","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"yiNugUQTnl"},{"type":"text","value":" repeats of the above,\nwe return the action with the highest UCB value ","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"eILqz42sEw"},{"type":"crossReference","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"(","key":"KBw0Q1SnxP"},{"type":"text","value":"4","key":"CqiDZaaT2k"},{"type":"text","value":")","key":"IRDisuZJbw"}],"identifier":"ucb-tree","label":"ucb-tree","kind":"equation","template":"(%s)","enumerator":"4","resolved":true,"html_id":"ucb-tree","key":"ImxAAnq1hE"},{"type":"text","value":".\nThen play continues.","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"KjXuN72ZrI"}],"key":"RDgO78TKzU"},{"type":"paragraph","position":{"start":{"line":577,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"text","value":"Between turns, we can keep the subtree whose statistics we have visited so far.\nHowever, the rest of the tree for the actions we did ","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"LoW6OwMbbW"},{"type":"emphasis","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"yTQDkleutM"}],"key":"iN18juxAq6"},{"type":"text","value":" end up taking gets discarded.","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"H3Dz4517nL"}],"key":"sQWs7Cauci"}],"enumerator":"1","html_id":"mcts-algorithm","key":"dfV1EoQYHQ"},{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":582,"column":1}},"children":[{"type":"text","value":"The application which brought the MCTS algorithm to fame was DeepMind’s ","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"kzjNkoAkyy"},{"type":"strong","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"AlphaGo","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"tPccMKa8Kd"}],"key":"mZ8pP6AkBV"},{"type":"text","value":" ","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"eQDxuGzwEJ"},{"type":"cite","kind":"narrative","label":"silver_mastering_2016","identifier":"silver_mastering_2016","children":[{"type":"text","value":"Silver ","key":"qux2kLhSSR"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"oVQffbOMnx"}],"key":"Y98gJV4fjn"},{"type":"text","value":" (2016)","key":"nBVtkNxM6Q"}],"enumerator":"1","key":"g8t6xUEkWx"},{"type":"text","value":".\nSince then, it has been used in numerous applications ranging from games to automated theorem proving.","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"aY2KhkwLQV"}],"key":"GECdP04fYm"},{"type":"paragraph","position":{"start":{"line":584,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"How accurate is this Monte Carlo estimation?\nIt depends heavily on the rollout policy ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"Tn6NZlndRC"},{"type":"inlineMath","value":"\\pi_\\text{rollout}","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>rollout</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{rollout}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">rollout</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FJdoWD8Muz"},{"type":"text","value":".\nIf the distribution ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"Q2x7e0Kvyx"},{"type":"inlineMath","value":"\\pi_\\text{rollout}","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>rollout</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{rollout}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">rollout</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MWnWCb8DrS"},{"type":"text","value":" induces over games is very different from the distribution seen during real gameplay,\nwe might end up with a poor value approximation.","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"q7iWzUi6W9"}],"key":"CcmWrhkcO2"}],"key":"PFPYTsbPKy"},{"type":"block","position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"Incorporating value functions and policies","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"L9yilRVGQN"}],"identifier":"incorporating-value-functions-and-policies","label":"Incorporating value functions and policies","html_id":"incorporating-value-functions-and-policies","implicit":true,"enumerator":"5.1","key":"dA65pWrd30"},{"type":"paragraph","position":{"start":{"line":593,"column":1},"end":{"line":595,"column":1}},"children":[{"type":"text","value":"To remedy this,\nwe might make use of a value function ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"yTLw3Vh5iC"},{"type":"inlineMath","value":"v : \\mathcal{S} \\to \\mathbb{R}","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>:</mo><mi mathvariant=\"script\">S</mi><mo>→</mo><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">v : \\mathcal{S} \\to \\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>","key":"FPrKHI0Uh1"},{"type":"text","value":" that more efficiently approximates the value of a state.\nThen, we can replace the simulation step of ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"WrqkQF3j6h"},{"type":"crossReference","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"children":[{"type":"text","value":"MCTS","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"GHCz0xydDM"}],"identifier":"mcts-algorithm","label":"mcts-algorithm","kind":"proof:algorithm","template":"Algorithm %s","enumerator":"1","resolved":true,"html_id":"mcts-algorithm","key":"iYx17ibliI"},{"type":"text","value":" with evaluating ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"GUjOPboJuw"},{"type":"inlineMath","value":"r = v(s_\\text{next})","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mi>v</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mtext>next</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r = v(s_\\text{next})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">next</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"NUmIXbRQyO"},{"type":"text","value":", where ","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"sI1DDAb1qb"},{"type":"inlineMath","value":"s_\\text{next} = P(s_\\text{new}, a_\\text{new})","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>next</mtext></msub><mo>=</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mtext>new</mtext></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s_\\text{next} = P(s_\\text{new}, a_\\text{new})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">next</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"F4GmPxTNZA"},{"type":"text","value":".","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"Cugx62SPw4"}],"key":"GqPb5dG19P"},{"type":"paragraph","position":{"start":{"line":597,"column":1},"end":{"line":598,"column":1}},"children":[{"type":"text","value":"We might also make use of a ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"s6ypkriMPq"},{"type":"strong","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"children":[{"type":"text","value":"“guiding” policy","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"s3TMz6DqXp"}],"key":"F8MgkYzTAk"},{"type":"text","value":" ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"Rc91tGLWWO"},{"type":"inlineMath","value":"\\pi_\\text{guide} : \\mathcal{S} \\to \\triangle(\\mathcal{A})","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>guide</mtext></msub><mo>:</mo><mi mathvariant=\"script\">S</mi><mo>→</mo><mi mathvariant=\"normal\">△</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"script\">A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{guide} : \\mathcal{S} \\to \\triangle(\\mathcal{A})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">guide</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">△</span><span class=\"mopen\">(</span><span class=\"mord mathcal\">A</span><span class=\"mclose\">)</span></span></span></span>","key":"vnOvFHS1Gj"},{"type":"text","value":" that provides “intuition” as to which actions are more valuable in a given state.\nWe can scale the exploration term of ","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"Dpn5GBrs2n"},{"type":"crossReference","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"children":[{"type":"text","value":"(","key":"LDU2s9gGK4"},{"type":"text","value":"4","key":"Eum320NQGH"},{"type":"text","value":")","key":"ay3sjMW86l"}],"identifier":"ucb-tree","label":"ucb-tree","kind":"equation","template":"(%s)","enumerator":"4","resolved":true,"html_id":"ucb-tree","key":"tANrjhjwI5"},{"type":"text","value":" according to the policy’s outputs.","position":{"start":{"line":597,"column":1},"end":{"line":597,"column":1}},"key":"qdtLeEEekQ"}],"key":"wgyB4CDmF6"},{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"Putting these together,\nwe can describe an updated version of MCTS that makes use of these value functions and policy:","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"lpw941g1U9"}],"key":"b47s0rj7wV"},{"type":"proof","kind":"algorithm","label":"mcts-policy-value","identifier":"mcts-policy-value","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Monte Carlo tree search with policy and value functions","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"m02k1v7x8n"}],"key":"IpEA3elnfd"},{"type":"paragraph","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"children":[{"type":"text","value":"Inputs:","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"key":"TkjXY3uhvR"}],"key":"UrUMiD3Fp0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":607,"column":1},"end":{"line":611,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"inlineMath","value":"T","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"GjjQEtk3gL"},{"type":"text","value":", the number of iterations per move","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"mwKXYpfg77"}],"key":"P50QiOYsHL"},{"type":"listItem","spread":true,"position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"inlineMath","value":"v","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"ZaYKyTVFPW"},{"type":"text","value":", a value function that evaluates how good a state is","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"s1ljY3sX6V"}],"key":"n3E85Nt6lh"},{"type":"listItem","spread":true,"position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"children":[{"type":"inlineMath","value":"\\pi_\\text{guide}","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>guide</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{guide}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">guide</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"M176LUt0Np"},{"type":"text","value":", a guiding policy that encourages certain actions","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"taarvJQX4Y"}],"key":"UjEAttNIPt"},{"type":"listItem","spread":true,"position":{"start":{"line":610,"column":1},"end":{"line":611,"column":1}},"children":[{"type":"inlineMath","value":"c","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"Z3QRc8jxnL"},{"type":"text","value":", a positive value that encourages exploration","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"NMt1v49W8A"}],"key":"csK8TICEQG"}],"key":"cFh5ABp5k8"},{"type":"paragraph","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"children":[{"type":"text","value":"To select a move in state ","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"nC0QMFPJqV"},{"type":"inlineMath","value":"s_\\text{start}","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>start</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_\\text{start}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">start</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"oS1p3RXhcB"},{"type":"text","value":", we repeat the following four steps ","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"FxiBqLeXJo"},{"type":"inlineMath","value":"T","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"umiACzWA8x"},{"type":"text","value":" times:","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"JwC1hgYJKJ"}],"key":"QY2bBfCQHF"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":614,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":614,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"strong","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"children":[{"type":"text","value":"Selection","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"zZ0d6wijIS"}],"key":"mQXOauQ0xY"},{"type":"text","value":": We start at ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"wACGOhZ6rx"},{"type":"inlineMath","value":"s = s_{\\text{start}}","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><msub><mi>s</mi><mtext>start</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s = s_{\\text{start}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">start</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TrL0kkWFLg"},{"type":"text","value":". Let ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"LQiGxez5Nu"},{"type":"text","value":"τ","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"FyIiRLQ4RG"},{"type":"text","value":" be an empty list that we will use to track states and actions.","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"wUWAb4zMlc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":615,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":615,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"text","value":"Until ","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"key":"B0rBt3Uwya"},{"type":"inlineMath","value":"s","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"y8sjuhmArT"},{"type":"text","value":" has at least one action that hasn’t been taken:","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"key":"ZmgYh0trcX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":616,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":616,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Choose ","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"ucy9Ha41dZ"},{"type":"inlineMath","value":"a \\gets \\argmax_k \\text{UCB}^{s, k}","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>←</mo><msub><mrow><mi mathvariant=\"normal\">arg max</mi><mo>⁡</mo></mrow><mi>k</mi></msub><msup><mtext>UCB</mtext><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">a \\gets \\argmax_k \\text{UCB}^{s, k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1665em;vertical-align:-0.2441em;\"></span><span class=\"mop\"><span class=\"mop\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">arg</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathrm\">max</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.242em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">UCB</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9223em;\"><span style=\"top:-3.1362em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span></span>","key":"BdW4h0v72e"},{"type":"text","value":", where\n","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"vNR1bwXayR"},{"type":"math","value":"\\text{UCB}^{s, a} = \\frac{W^{s, a}}{N^s} + c \\cdot \\pi_\\text{guide}(a \\mid s) \\sqrt{\\frac{\\ln N^s}{N^{s, a}}}","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"identifier":"ucb-tree-policy","label":"ucb-tree-policy","html_id":"ucb-tree-policy","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mtext>UCB</mtext><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>=</mo><mfrac><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><msup><mi>N</mi><mi>s</mi></msup></mfrac><mo>+</mo><mi>c</mi><mo>⋅</mo><msub><mi>π</mi><mtext>guide</mtext></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy=\"false\">)</mo><msqrt><mfrac><mrow><mi>ln</mi><mo>⁡</mo><msup><mi>N</mi><mi>s</mi></msup></mrow><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">\\text{UCB}^{s, a} = \\frac{W^{s, a}}{N^s} + c \\cdot \\pi_\\text{guide}(a \\mid s) \\sqrt{\\frac{\\ln N^s}{N^{s, a}}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7376em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">UCB</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7376em;\"><span style=\"top:-3.1362em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">guide</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7634em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6766em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6366em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7634em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"idBVEkVsTs"}],"key":"U0F60B0Chw"},{"type":"listItem","spread":true,"position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"children":[{"type":"text","value":"Append ","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"vkBSEnAeQQ"},{"type":"inlineMath","value":"(s, a)","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"ZfaiSTZBw9"},{"type":"text","value":" to ","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"i7u9IyaHU8"},{"type":"text","value":"τ","position":{"start":{"line":621,"column":1},"end":{"line":621,"column":1}},"key":"g3UsQ7Bpiv"}],"key":"kFro6bIQcO"},{"type":"listItem","spread":true,"position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"key":"z7HvbuuBxH"},{"type":"inlineMath","value":"s \\gets P(s, a)","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>←</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s \\gets P(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"XkhYaTCsrG"}],"key":"hrck2rZeQ8"}],"key":"B7o3kjeinD"}],"key":"gIOqNu65ED"}],"key":"tlH4f0Qduy"}],"key":"pDyrLQ59Hx"},{"type":"listItem","spread":true,"position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"children":[{"type":"strong","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"children":[{"type":"text","value":"Expansion","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"bKsZ6UcCle"}],"key":"PfswSnrl8g"},{"type":"text","value":": Let ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"PmUcGxQPll"},{"type":"inlineMath","value":"s_\\text{new}","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_\\text{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lGm4WhTcs3"},{"type":"text","value":" denote the final state in ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"wkStXpbg0A"},{"type":"text","value":"τ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"pRq93RZ3rd"},{"type":"text","value":" (that has at least one action that hasn’t been taken). Choose one of these unexplored actions from ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"K1r6Y5P17Y"},{"type":"inlineMath","value":"s_\\text{new}","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">s_\\text{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dUFmQJkV7S"},{"type":"text","value":". Call it ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"yzwjnPLT5j"},{"type":"inlineMath","value":"a_{\\text{new}}","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">a_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jPwYvBq5FR"},{"type":"text","value":". Add it to ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"WIWEfDcNpw"},{"type":"text","value":"τ","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"CIV9yuGhXJ"},{"type":"text","value":".","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"r2MUt4SX4z"}],"key":"y2foS40KVa"},{"type":"listItem","spread":true,"position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"strong","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"text","value":"Simulation","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"g9GIrgjFtf"}],"key":"FJWtxfkvYa"},{"type":"text","value":": Let ","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"fjIotJQdaV"},{"type":"inlineMath","value":"s_\\text{next} = P(s_\\text{new}, a_\\text{new})","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mtext>next</mtext></msub><mo>=</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mtext>new</mtext></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s_\\text{next} = P(s_\\text{new}, a_\\text{new})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">next</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"IPjkgVtzyt"},{"type":"text","value":". Evaluate ","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"rpsOS3CkUC"},{"type":"inlineMath","value":"r = v(s_\\text{next})","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mi>v</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mtext>next</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r = v(s_\\text{next})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">next</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"FRCLCyTAwG"},{"type":"text","value":". This approximates the value of the game after taking the action ","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"dfPoJgJnx4"},{"type":"inlineMath","value":"a_\\text{new}","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">a_\\text{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ieCA9xPSu4"},{"type":"text","value":".","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"Cqq1HET2UE"}],"key":"igsn8J44B7"},{"type":"listItem","spread":true,"position":{"start":{"line":625,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"strong","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"children":[{"type":"text","value":"Backup","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"YCmT69oaC6"}],"key":"HeuRNEPSVb"},{"type":"text","value":": For each ","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"MgStJbznNL"},{"type":"inlineMath","value":"(s, a) \\in \\tau","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">(s, a) \\in \\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"KMISx3UZ7F"},{"type":"text","value":":","position":{"start":{"line":625,"column":1},"end":{"line":625,"column":1}},"key":"LKDiqYHbd9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":626,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"children":[{"type":"inlineMath","value":"N^{s, a} \\gets N^{s, a} + 1","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>←</mo><msup><mi>N</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N^{s, a} \\gets N^{s, a} + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"AqCQTm9CHX"}],"key":"bqqoEsb0z9"},{"type":"listItem","spread":true,"position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"children":[{"type":"inlineMath","value":"W^{s, a} \\gets W^{s, a} + r","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>←</mo><msup><mi>W</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi></mrow></msup><mo>+</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">W^{s, a} \\gets W^{s, a} + r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"VXVjqxfKH5"}],"key":"ILQDG1abal"},{"type":"listItem","spread":true,"position":{"start":{"line":628,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"inlineMath","value":"N^s \\gets N^s + 1","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>s</mi></msup><mo>←</mo><msup><mi>N</mi><mi>s</mi></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N^s \\gets N^s + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"lEUuOebYRP"}],"key":"WzgtPPCqIL"}],"key":"QokbMcWQsn"}],"key":"y38QP3Sg6j"}],"key":"DipEY7M0c1"},{"type":"paragraph","position":{"start":{"line":630,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"text","value":"We finally return the action with the highest UCB value ","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"D0Kpj9v2mi"},{"type":"crossReference","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"children":[{"type":"text","value":"(","key":"Wly3kjnqic"},{"type":"text","value":"5","key":"S6MRyx7f1a"},{"type":"text","value":")","key":"zIoaQgQ85p"}],"identifier":"ucb-tree-policy","label":"ucb-tree-policy","kind":"equation","template":"(%s)","enumerator":"5","resolved":true,"html_id":"ucb-tree-policy","key":"fXA0FIQ8nm"},{"type":"text","value":".\nThen play continues. As before, we can reuse the tree across timesteps.","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"TAveUi88e4"}],"key":"zr9iIs4Hch"}],"enumerator":"2","html_id":"mcts-policy-value","key":"S2NWSIdBRg"}],"key":"WGvij0YDtm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class EdgeStatistics(NamedTuple):\n    wins: int = 0\n    visits: int = 0\n\nclass MCTSTree:\n    \"\"\"A representation of the search tree.\n\n    Maps each state-action pair to its number of wins and the number of visits.\n    \"\"\"\n\n    edges: dict[tuple[\"State\", \"Action\"], EdgeStatistics]\n\ndef mcts_iter(tree, s_init):\n    s = s_init\n    while all((s, a) in tree for a in env.action_state(s)):","key":"NBieOLVKAY"},{"type":"output","id":"-mjcpm41Vd2lbGrqSzQf2","data":[],"key":"KhhKeHr19d"}],"data":{},"key":"UIovjV9xzb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":653,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"How do we actually compute a useful ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"q0KYKQM5KA"},{"type":"inlineMath","value":"\\pi_\\text{guide}","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>guide</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{guide}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">guide</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gqLAlFxBjN"},{"type":"text","value":" and ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"uU3y6hMxi0"},{"type":"inlineMath","value":"v","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"tCuwdoVQd0"},{"type":"text","value":"?\nIf we have some existing dataset of trajectories,\nwe could use ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"m15d4BApmq"},{"type":"link","url":"/imitation-learning","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"children":[{"type":"text","value":"supervised learning","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"lsNHal7FVf"}],"urlSource":"./imitation_learning.md","dataUrl":"/imitation-learning.json","internal":true,"protocol":"file","key":"DYPLIO2RIR"},{"type":"text","value":" (that is, imitation learning)\nto generate a policy ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"hkyaeqodCu"},{"type":"inlineMath","value":"\\pi_\\text{guide}","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mtext>guide</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_\\text{guide}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">guide</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZaddJ6bA6G"},{"type":"text","value":" via behavioral cloning\nand learn ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"wTjcpwQVG3"},{"type":"inlineMath","value":"v","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"Kd4reGuIWG"},{"type":"text","value":" by regressing the game outcomes onto states.\nThen, plugging these into ","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"JN4z2TgYuR"},{"type":"crossReference","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"children":[{"type":"text","value":"the above algorithm","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"SCMGSdL1hw"}],"identifier":"mcts-policy-value","label":"mcts-policy-value","kind":"proof:algorithm","template":"Algorithm %s","enumerator":"2","resolved":true,"html_id":"mcts-policy-value","key":"XCvDwCeN9y"},{"type":"text","value":"\nresults in a stronger policy by using tree search to “think ahead”.","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"ojGaHDPEhJ"}],"key":"rhUCtwDBiC"},{"type":"paragraph","position":{"start":{"line":661,"column":1},"end":{"line":662,"column":1}},"children":[{"type":"text","value":"But we don’t have to stop at just one improvement step;\nwe could iterate this process via ","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"key":"jhDGLLwUxf"},{"type":"strong","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"children":[{"type":"text","value":"self-play","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"key":"qppAgdP4N2"}],"key":"Hqu3ERKH3K"},{"type":"text","value":".","position":{"start":{"line":661,"column":1},"end":{"line":661,"column":1}},"key":"KINUu68Rlr"}],"key":"fE6nhDlzSj"}],"key":"FFWiZyMYZ0"},{"type":"block","position":{"start":{"line":664,"column":1},"end":{"line":664,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"children":[{"type":"text","value":"Self-play","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"AqHUK8gOwl"}],"identifier":"self-play","label":"Self-play","html_id":"self-play","implicit":true,"enumerator":"5.2","key":"BRb00Th5I7"},{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":678,"column":1}},"children":[{"type":"text","value":"Recall the ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"lOhpyB0TBl"},{"type":"crossReference","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"policy iteration","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"ljY1n6xZA4"}],"identifier":"policy_iteration","label":"policy_iteration","kind":"heading","template":"Section %s","enumerator":"1.5.3.2","resolved":true,"html_id":"policy-iteration","remote":true,"url":"/mdps","dataUrl":"/mdps.json","key":"N9CLnIOWA1"},{"type":"text","value":" algorithm from the ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"SQSeuY1ZRG"},{"type":"link","url":"/mdps","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"MDPs","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"mZ1ie9dA6T"}],"urlSource":"./mdps.md","dataUrl":"/mdps.json","internal":true,"protocol":"file","key":"nQow72vxED"},{"type":"text","value":" chapter.\nPolicy iteration alternates between ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"BGKa6mB1cn"},{"type":"strong","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"policy evaluation","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"TfcKYmMzCx"}],"key":"dOve8Zq7jw"},{"type":"text","value":" (taking ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"W2ve8p3CUp"},{"type":"text","value":"π","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"HaTzM0OzDD"},{"type":"text","value":" and computing ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"FvOaUVUOSC"},{"type":"inlineMath","value":"V^\\pi","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup></mrow><annotation encoding=\"application/x-tex\">V^\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span></span></span></span></span></span></span>","key":"dOqss5fJ2L"},{"type":"text","value":")\nand ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"AX0TfR8ffJ"},{"type":"strong","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"policy improvement","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"mSA1cNa9Xc"}],"key":"vutkTMZwB7"},{"type":"text","value":" (setting ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"d0W7rPLfLj"},{"type":"text","value":"π","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"ZZtzP07hLD"},{"type":"text","value":" to be greedy with respect to ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"Y9IrjsytH1"},{"type":"inlineMath","value":"V^\\pi","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup></mrow><annotation encoding=\"application/x-tex\">V^\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span></span></span></span></span></span></span>","key":"LxOscyXmBm"},{"type":"text","value":").\nAbove, we saw how MCTS can be thought of as a “policy improvement” operation:\nfor a given policy ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"Z1dG6uJWEL"},{"type":"inlineMath","value":"\\pi^0","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>π</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\pi^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>","key":"h9S8b4tRvp"},{"type":"text","value":",\nwe can use it to guide MCTS,\nresulting in an algorithm that is itself a policy ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"dYTAnW7CQs"},{"type":"inlineMath","value":"\\pi^0_\\text{MCTS}","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>π</mi><mtext>MCTS</mtext><mn>0</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\pi^0_\\text{MCTS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4247em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">MCTS</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Y76baiNxlT"},{"type":"text","value":" that maps from states to actions.\nNow, we can use ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"ZxFHkiL4N6"},{"type":"link","url":"/imitation-learning","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"behavioral cloning","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"CSyEuK9y0R"}],"urlSource":"./imitation_learning.md","dataUrl":"/imitation-learning.json","internal":true,"protocol":"file","key":"e5s7HMYiqq"},{"type":"text","value":"\nto obtain a new policy ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"JvUZA9GJQJ"},{"type":"inlineMath","value":"\\pi^1","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>π</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\pi^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span>","key":"m5wpsK0fnR"},{"type":"text","value":" that imitates ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"RFki6x5m2c"},{"type":"inlineMath","value":"\\pi^0_\\text{MCTS}","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>π</mi><mtext>MCTS</mtext><mn>0</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\pi^0_\\text{MCTS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4247em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">MCTS</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yaYgt3bEEI"},{"type":"text","value":".\nWe can now use ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"SSEt6iAsKx"},{"type":"inlineMath","value":"\\pi^1","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>π</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\pi^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span>","key":"W0Muxl7Xpy"},{"type":"text","value":" to guide MCTS,\nand repeat.","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"c8e66B2wal"}],"key":"SYzySu3it7"},{"type":"proof","kind":"algorithm","label":"mcts-self-play","identifier":"mcts-self-play","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"MCTS with self-play","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"Zo95zKSr5j"}],"key":"M7dv0qEKbA"},{"type":"paragraph","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"text","value":"Input:","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"cir8hj81ND"}],"key":"fzbJu66tbg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":685,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"children":[{"type":"text","value":"A parameterized policy class ","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"TAHN9nD79l"},{"type":"inlineMath","value":"\\pi_\\theta : \\mathcal{S} \\to \\triangle(\\mathcal{A})","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo>:</mo><mi mathvariant=\"script\">S</mi><mo>→</mo><mi mathvariant=\"normal\">△</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"script\">A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi_\\theta : \\mathcal{S} \\to \\triangle(\\mathcal{A})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">△</span><span class=\"mopen\">(</span><span class=\"mord mathcal\">A</span><span class=\"mclose\">)</span></span></span></span>","key":"Pykk9fn96z"}],"key":"kC1563qnCk"},{"type":"listItem","spread":true,"position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"A parameterized value function class ","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"zvRHHmsv7h"},{"type":"inlineMath","value":"v_\\lambda : \\mathcal{S} \\to \\mathbb{R}","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>λ</mi></msub><mo>:</mo><mi mathvariant=\"script\">S</mi><mo>→</mo><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">v_\\lambda : \\mathcal{S} \\to \\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>","key":"EpdUX5ZSS7"}],"key":"mXTAKLJTnc"},{"type":"listItem","spread":true,"position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"text","value":"A number of trajectories ","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"eVL3PFx0pB"},{"type":"inlineMath","value":"M","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>","key":"uEurILwout"},{"type":"text","value":" to generate","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"FzFAfsOsWq"}],"key":"oVz0lPciRM"},{"type":"listItem","spread":true,"position":{"start":{"line":688,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"text","value":"The initial parameters ","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"key":"oyxOlBzMxl"},{"type":"inlineMath","value":"\\theta^0, \\lambda^0","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mn>0</mn></msup><mo separator=\"true\">,</mo><msup><mi>λ</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\theta^0, \\lambda^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>","key":"b0lKPhq9SQ"}],"key":"ggWm9mcLdq"}],"key":"NkTudvoTA5"},{"type":"paragraph","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"BrwWedBKbb"},{"type":"inlineMath","value":"t = 0, \\dots, T-1","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t = 0, \\dots, T-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GdrbwLhNLH"},{"type":"text","value":":","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"e55ccimfYE"}],"key":"xKSiogOCrY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":692,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"strong","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"text","value":"Policy improvement","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"VsqUOiF5zu"}],"key":"Q2hQiEdOvq"},{"type":"text","value":": Let ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"wbDtLdK6em"},{"type":"inlineMath","value":"\\pi^t_\\text{MCTS}","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>π</mi><mtext>MCTS</mtext><mi>t</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\pi^t_\\text{MCTS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0689em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7936em;\"><span style=\"top:-2.4247em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">MCTS</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YZqR7UDmD0"},{"type":"text","value":" denote the policy obtained by ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"Z32eYHPBOt"},{"type":"crossReference","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"text","value":"Algorithm ","key":"qPZGMnjRhy"},{"type":"text","value":"2","key":"O7KqEyJJpj"}],"identifier":"mcts-policy-value","label":"mcts-policy-value","kind":"proof:algorithm","template":"Algorithm %s","enumerator":"2","resolved":true,"html_id":"mcts-policy-value","key":"Tvronwwtqy"},{"type":"text","value":" with ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"QbO9Hssjs5"},{"type":"inlineMath","value":"\\pi_{\\theta^t}","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><msup><mi>θ</mi><mi>t</mi></msup></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_{\\theta^t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5935em;vertical-align:-0.1629em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5371em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1629em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pGGxfGzfUz"},{"type":"text","value":" and ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"WcTdrX7r7x"},{"type":"inlineMath","value":"v_{\\lambda^t}","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><msup><mi>λ</mi><mi>t</mi></msup></msub></mrow><annotation encoding=\"application/x-tex\">v_{\\lambda^t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5935em;vertical-align:-0.1629em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5371em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1629em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZgAqMHefix"},{"type":"text","value":". We use ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"HJHLijydUE"},{"type":"inlineMath","value":"\\pi^t_\\text{MCTS}","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>π</mi><mtext>MCTS</mtext><mi>t</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\pi^t_\\text{MCTS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0689em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7936em;\"><span style=\"top:-2.4247em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">MCTS</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ldkxni5mrQ"},{"type":"text","value":" to play against itself ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"cUPLmSFMN6"},{"type":"inlineMath","value":"M","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>","key":"vQ4KqsZqlR"},{"type":"text","value":" times. This generates ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"BNhsXZavNR"},{"type":"inlineMath","value":"M","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>","key":"Ebia58B4b3"},{"type":"text","value":" trajectories ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"L17M8Sa6IX"},{"type":"inlineMath","value":"\\tau_0, \\dots, \\tau_{M-1}","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>τ</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>τ</mi><mrow><mi>M</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tau_0, \\dots, \\tau_{M-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Fje37UGVQc"},{"type":"text","value":".","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"nZGwjEge2b"}],"key":"fw80CuJ3N7"},{"type":"listItem","spread":true,"position":{"start":{"line":693,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"strong","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"children":[{"type":"text","value":"Policy evaluation","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"key":"HFD7PvSK9X"}],"key":"d6bfe1yzoz"},{"type":"text","value":": Use behavioral cloning to find a set of policy parameters ","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"key":"kJSojRWcjB"},{"type":"inlineMath","value":"\\theta^{t+1}","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>θ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\theta^{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"FPotapUQGV"},{"type":"text","value":" that mimic the behavior of ","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"key":"AfI3gLQGsJ"},{"type":"inlineMath","value":"\\pi^t_\\text{MCTS}","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>π</mi><mtext>MCTS</mtext><mi>t</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\pi^t_\\text{MCTS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0689em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7936em;\"><span style=\"top:-2.4247em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">MCTS</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IAbYSlzRrz"},{"type":"text","value":" and a set of value function parameters ","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"key":"pKYsIX4fGf"},{"type":"inlineMath","value":"\\lambda^{t+1}","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>λ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\lambda^{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"N1tUvdecYO"},{"type":"text","value":" that approximate its value function. That is,","position":{"start":{"line":693,"column":1},"end":{"line":693,"column":1}},"key":"jqWVOPLYY3"},{"type":"math","tight":"before","value":"\\begin{align*}\n  \\theta^{t+1} &\\gets \\argmin_\\theta \\sum_{m=0}^{M-1} \\sum_{\\hi=0}^{H-1} - \\log \\pi_\\theta(a^m_\\hi \\mid s^m_\\hi) \\\\\n  \\lambda^{t+1} &\\gets \\argmin_\\lambda \\sum_{m=0}^{M-1} \\sum_{\\hi=0}^{H-1} (v_\\lambda(s^m_\\hi) - R(\\tau_m))^2\n  \\end{align*}","position":{"start":{"line":694,"column":1},"end":{"line":696,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>θ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>←</mo><munder><mrow><mi mathvariant=\"normal\">arg min</mi><mo>⁡</mo></mrow><mi>θ</mi></munder><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>M</mi><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>H</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><msubsup><mi>a</mi><mi>h</mi><mi>m</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>h</mi><mi>m</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>λ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>←</mo><munder><mrow><mi mathvariant=\"normal\">arg min</mi><mo>⁡</mo></mrow><mi>λ</mi></munder><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>M</mi><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>H</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo stretchy=\"false\">(</mo><msub><mi>v</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><msubsup><mi>s</mi><mi>h</mi><mi>m</mi></msubsup><mo stretchy=\"false\">)</mo><mo>−</mo><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n  \\theta^{t+1} &amp;\\gets \\argmin_\\theta \\sum_{m=0}^{M-1} \\sum_{\\hi=0}^{H-1} - \\log \\pi_\\theta(a^m_\\hi \\mid s^m_\\hi) \\\\\n  \\lambda^{t+1} &amp;\\gets \\argmin_\\lambda \\sum_{m=0}^{M-1} \\sum_{\\hi=0}^{H-1} (v_\\lambda(s^m_\\hi) - R(\\tau_m))^2\n  \\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6.8609em;vertical-align:-3.1804em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6804em;\"><span style=\"top:-5.6804em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1804em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6804em;\"><span style=\"top:-5.6804em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.1535em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">arg</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathrm\">min</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9465em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.1535em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">arg</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathrm\">min</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9465em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1804em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"io6KL9C7FZ"}],"key":"cXahLHSYco"}],"key":"x8uTfyWQn0"},{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"text","value":"Note that in implementation,\nthe policy and value are typically both returned by a single deep neural network,\nthat is, with a single set of parameters,\nand the two loss functions are added together.","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"HxCQdEIxrL"}],"key":"Pq7DPQb5N2"}],"enumerator":"3","html_id":"mcts-self-play","key":"s11ADIm4Xg"},{"type":"paragraph","position":{"start":{"line":705,"column":1},"end":{"line":705,"column":1}},"children":[{"type":"text","value":"This algorithm was brought to fame by AlphaGo Zero ","position":{"start":{"line":705,"column":1},"end":{"line":705,"column":1}},"key":"qS6bLfiakm"},{"type":"cite","kind":"narrative","label":"silver_mastering_2017","identifier":"silver_mastering_2017","children":[{"type":"text","value":"Silver ","key":"rzaKYXTQsi"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"MDraGolvef"}],"key":"lW2maCGKr0"},{"type":"text","value":" (2017)","key":"gFBzcn5Dgd"}],"enumerator":"2","key":"oDV4P14pzz"},{"type":"text","value":".","position":{"start":{"line":705,"column":1},"end":{"line":705,"column":1}},"key":"PfEeG1SWIG"}],"key":"z8hAwFKQLt"}],"key":"N5DuvXTodB"},{"type":"block","position":{"start":{"line":707,"column":1},"end":{"line":707,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":709,"column":1},"end":{"line":709,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":709,"column":1},"end":{"line":709,"column":1}},"key":"NFFlK6ckWo"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"enumerator":"6","key":"hXqFSM6PNT"},{"type":"paragraph","position":{"start":{"line":711,"column":1},"end":{"line":718,"column":1}},"children":[{"type":"text","value":"In this chapter,\nwe explored tree search-based algorithms for deterministic, zero sum, fully observable two-player games.\nWe began with ","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"GPkM7dqdCQ"},{"type":"crossReference","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"children":[{"type":"text","value":"min-max search","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"vFTYRIHzF3"}],"identifier":"min-max-search","label":"min-max-search","kind":"heading","template":"Section %s","enumerator":"3","resolved":true,"html_id":"min-max-search","key":"RdBpJrFOlT"},{"type":"text","value":",\nan algorithm for exactly solving the game value of every possible state.\nHowever, this is impossible to execute in practice,\nand so we must resort to various ways to reduce the number of states and actions that we must explore.\n","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"Fel5mDb4qc"},{"type":"crossReference","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"children":[{"type":"text","value":"Alpha-beta search","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"eSNTL0hmzm"}],"identifier":"alpha-beta-search","label":"alpha-beta-search","kind":"heading","template":"Section %s","enumerator":"4","resolved":true,"html_id":"alpha-beta-search","key":"vaCTa1ASYC"},{"type":"text","value":" does this by ","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"Ffbqn8lUXt"},{"type":"emphasis","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"children":[{"type":"text","value":"pruning","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"KXYZeiiqox"}],"key":"Oc28tHCaDj"},{"type":"text","value":" away states that we already know to be suboptimal,\nand ","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"TyrlnMiIsy"},{"type":"crossReference","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"children":[{"type":"text","value":"Monte Carlo Tree Search","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"Qhdjdt9QLb"}],"identifier":"monte-carlo-tree-search","label":"monte-carlo-tree-search","kind":"heading","template":"Section %s","enumerator":"5","resolved":true,"html_id":"monte-carlo-tree-search","key":"X57yvycnvy"},{"type":"text","value":" ","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"SeU5S3Ere1"},{"type":"emphasis","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"children":[{"type":"text","value":"approximates","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"sRrObjXR2E"}],"key":"mzcPEAjN2R"},{"type":"text","value":" the value of states instead of evaluating them exactly.","position":{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},"key":"psP3qOycTr"}],"key":"C3UaYviFIv"}],"key":"a4lJHh9DWd"},{"type":"block","position":{"start":{"line":720,"column":1},"end":{"line":720,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"key":"s3cp7hQQWt"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"enumerator":"7","key":"qSYdB9p3Lm"},{"type":"paragraph","position":{"start":{"line":724,"column":1},"end":{"line":732,"column":1}},"children":[{"type":"text","value":"Chapter 5 of ","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"MmCWiIVKZj"},{"type":"cite","kind":"narrative","label":"russell_artificial_2021","identifier":"russell_artificial_2021","children":[{"type":"text","value":"Russell & Norvig (2021)","key":"hCWlPWupW1"}],"enumerator":"3","key":"jUoVedwQsG"},{"type":"text","value":" provides an excellent overview of search methods in games.\nThe original AlphaGo paper ","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"SkhWv84ASE"},{"type":"cite","kind":"narrative","label":"silver_mastering_2016","identifier":"silver_mastering_2016","children":[{"type":"text","value":"Silver ","key":"X4RY5jKmli"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"n5YyDibz1M"}],"key":"fsG0KCNuoH"},{"type":"text","value":" (2016)","key":"AJdrxN4Thz"}],"enumerator":"1","key":"Ju3315qERk"},{"type":"text","value":" was a groundbreaking application of these technologies.\n","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"y2G2PJKyBW"},{"type":"cite","kind":"narrative","label":"silver_mastering_2017","identifier":"silver_mastering_2017","children":[{"type":"text","value":"Silver ","key":"Snb97m64Am"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"a5s2xlbg30"}],"key":"r2SPPYHpGu"},{"type":"text","value":" (2017)","key":"AZfgQ3urnn"}],"enumerator":"2","key":"mvF2eMWZmu"},{"type":"text","value":" removed the imitation learning phase,\nlearning from scratch.\nAlphaZero ","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"TuGoXGDGxv"},{"type":"cite","kind":"narrative","label":"silver_general_2018","identifier":"silver_general_2018","children":[{"type":"text","value":"Silver ","key":"Os8Kl4VWSq"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"vet5OajhG4"}],"key":"ZcdjYnDyKp"},{"type":"text","value":" (2018)","key":"h7N2PL546d"}],"enumerator":"4","key":"Ia4uOZdYto"},{"type":"text","value":" then extended to other games beyond Go,\nnamely shogi and chess,\nalso learning from scratch.\nIn MuZero ","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"CSj4MetHJX"},{"type":"cite","kind":"narrative","label":"schrittwieser_mastering_2020","identifier":"schrittwieser_mastering_2020","children":[{"type":"text","value":"Schrittwieser ","key":"Ydfap1XEzM"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"jbR1txfm2W"}],"key":"h15sxLS4Hq"},{"type":"text","value":" (2020)","key":"QmDnHpxjrQ"}],"enumerator":"5","key":"npKgct2Pk4"},{"type":"text","value":",\nthis was further extended by learning a model of the game dynamics.","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"VKXRkRxv5C"}],"key":"eQR1yAKmr2"}],"key":"Yfrgg7yCqA"}],"key":"IneJrQpWMk"},"references":{"cite":{"order":["silver_mastering_2016","silver_mastering_2017","russell_artificial_2021","silver_general_2018","schrittwieser_mastering_2020"],"data":{"silver_mastering_2016":{"label":"silver_mastering_2016","enumerator":"1","doi":"10.1038/nature16961","html":"Silver, D., Huang, A., Maddison, C. J., Guez, A., Sifre, L., van den Driessche, G., Schrittwieser, J., Antonoglou, I., Panneershelvam, V., Lanctot, M., Dieleman, S., Grewe, D., Nham, J., Kalchbrenner, N., Sutskever, I., Lillicrap, T., Leach, M., Kavukcuoglu, K., Graepel, T., & Hassabis, D. (2016). Mastering the Game of Go with Deep Neural Networks and Tree Search. <i>Nature</i>, <i>529</i>(7587), 484–489. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1038/nature16961\">10.1038/nature16961</a>","url":"https://doi.org/10.1038/nature16961"},"silver_mastering_2017":{"label":"silver_mastering_2017","enumerator":"2","doi":"10.1038/nature24270","html":"Silver, D., Schrittwieser, J., Simonyan, K., Antonoglou, I., Huang, A., Guez, A., Hubert, T., Baker, L., Lai, M., Bolton, A., Chen, Y., Lillicrap, T., Hui, F., Sifre, L., van den Driessche, G., Graepel, T., & Hassabis, D. (2017). Mastering the Game of Go without Human Knowledge. <i>Nature</i>, <i>550</i>(7676), 354–359. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1038/nature24270\">10.1038/nature24270</a>","url":"https://doi.org/10.1038/nature24270"},"russell_artificial_2021":{"label":"russell_artificial_2021","enumerator":"3","html":"Russell, S. J., & Norvig, P. (2021). <i>Artificial Intelligence: A Modern Approach</i> (Fourth edition). Pearson."},"silver_general_2018":{"label":"silver_general_2018","enumerator":"4","doi":"10.1126/science.aar6404","html":"Silver, D., Hubert, T., Schrittwieser, J., Antonoglou, I., Lai, M., Guez, A., Lanctot, M., Sifre, L., Kumaran, D., Graepel, T., Lillicrap, T., Simonyan, K., & Hassabis, D. (2018). A General Reinforcement Learning Algorithm That Masters Chess, Shogi, and Go through Self-Play. <i>Science</i>, <i>362</i>(6419), 1140–1144. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1126/science.aar6404\">10.1126/science.aar6404</a>","url":"https://doi.org/10.1126/science.aar6404"},"schrittwieser_mastering_2020":{"label":"schrittwieser_mastering_2020","enumerator":"5","doi":"10.1038/s41586-020-03051-4","html":"Schrittwieser, J., Antonoglou, I., Hubert, T., Simonyan, K., Sifre, L., Schmitt, S., Guez, A., Lockhart, E., Hassabis, D., Graepel, T., Lillicrap, T., & Silver, D. (2020). Mastering Atari, Go, Chess and Shogi by Planning with a Learned Model. <i>Nature</i>, <i>588</i>(7839), 604–609. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1038/s41586-020-03051-4\">10.1038/s41586-020-03051-4</a>","url":"https://doi.org/10.1038/s41586-020-03051-4"}}}},"footer":{"navigation":{"prev":{"title":"7 Imitation Learning","url":"/imitation-learning","group":"CS/STAT 184: Introduction to Reinforcement Learning"},"next":{"title":"9 Exploration in MDPs","url":"/exploration","group":"CS/STAT 184: Introduction to Reinforcement Learning"}}},"domain":"http://localhost:3000"}